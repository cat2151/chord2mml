!function(r,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t=e();for(var n in t)("object"==typeof exports?exports:r)[n]=t[n]}}(self,(()=>(()=>{"use strict";var r={699:r=>{function e(r){switch(r){case"ionian":return[0,2,4,5,7,9,11];case"dorian":return[0,2,3,5,7,9,10];case"phrygian":return[0,1,3,5,7,8,10];case"lydian":return[0,2,4,6,7,9,11];case"mixolydian":return[0,2,4,5,7,9,10];case"aeolian":return[0,2,3,5,7,8,10];case"locrian":return[0,1,3,5,6,8,10];default:throw new Error("ERROR : getOffsetsByScale")}}function t(r,e,t){let n;switch(r){case"C":n=0;break;case"D":n=2;break;case"E":n=4;break;case"F":n=5;break;case"G":n=7;break;case"A":n=9;break;case"B":n=11;break;default:throw new Error("ERROR : getRootCdefgabOffset")}return n+=e.length-t.length,n}function n(r,e,t,o){var s=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(s,n.prototype),s.expected=e,s.found=t,s.location=o,s.name="SyntaxError",s}function o(r,e,t){return t=t||" ",r.length>e?r:(e-=r.length,r+(t+=t.repeat(e)).slice(0,e))}!function(r,e){function t(){this.constructor=r}t.prototype=e.prototype,r.prototype=new t}(n,Error),n.prototype.format=function(r){var e="Error: "+this.message;if(this.location){var t,n=null;for(t=0;t<r.length;t++)if(r[t].source===this.location.source){n=r[t].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,a=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,u=this.location.source+":"+a.line+":"+a.column;if(n){var c=this.location.end,i=o("",a.line.toString().length," "),l=n[s.line-1],h=(s.line===c.line?c.column:l.length+1)-s.column||1;e+="\n --\x3e "+u+"\n"+i+" |\n"+a.line+" | "+l+"\n"+i+" | "+o("",s.column-1," ")+o("",h,"^")}else e+="\n at "+u}return e},n.buildMessage=function(r,e){var t={literal:function(r){return'"'+o(r.text)+'"'},class:function(r){var e=r.parts.map((function(r){return Array.isArray(r)?s(r[0])+"-"+s(r[1]):s(r)}));return"["+(r.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function o(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function s(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function a(r){return t[r.type](r)}return"Expected "+function(r){var e,t,n=r.map(a);if(n.sort(),n.length>0){for(e=1,t=1;e<n.length;e++)n[e-1]!==n[e]&&(n[t]=n[e],t++);n.length=t}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(r)+" but "+function(r){return r?'"'+o(r)+'"':"end of input"}(e)+" found."},r.exports={SyntaxError:n,parse:function(r,o){var s,a={},u=(o=void 0!==o?o:{}).grammarSource,c={CHORDS:Rn},i=Rn,l="/",h="on",f="over",b="chord over bass note",p="slash chord inversion",v="upper structure triad",d="upper structure",g="ust",m="us",w="polychord",A="poly",y="/*",C="*/",k="root inv",L="1st inv",I="2nd inv",R="3rd inv",x="close harmony",E="close",O="drop2",S="drop-2",j="open triad",V="drop4",F="drop-4",Q="drop2and4",M="drop-2-and-4",P="no bass",q="bass is root",N="bass plays root",D="bass play root",J="bpm",T="tempo",B="|",G=" / ",U="key",K="ionian",_="dorian",H="phrygian",z="lydian",W="mixolydian",X="aeolian",Y="locrian",Z="octave",$="up",rr="down",er="VII",tr="III",nr="VI",or="IV",sr="II",ar="V",ur="I",cr="maj",ir="M",lr="maj7",hr="M7",fr="△",br="min",pr="m",vr="-",dr="min7",gr="m7",mr="-7",wr="^",Ar=" - ",yr="→",Cr="Strings",kr="Ensemble",Lr="1",Ir="Str.",Rr="2",xr="voice aahs",Er="choir aahs",Or="choir",Sr="chor.",jr=/^[,.]/,Vr=/^[^*\/]/,Fr=/^[0-9]/,Qr=/^[ =]/,Mr=/^[A-G]/,Pr=/^[ \-]/,qr=/^[#\uFF03\u266F]/,Nr=/^[b\u266D]/,Dr=/^[0-3]/,Jr=/^[ \t\n\r]/,Tr=An("/",!1),Br=An("on",!1),Gr=An("over",!1),Ur=An("chord over bass note",!0),Kr=yn([",","."],!1,!1),_r=An("slash chord inversion",!0),Hr=An("upper structure triad",!0),zr=An("upper structure",!0),Wr=An("UST",!0),Xr=An("US",!0),Yr=An("polychord",!0),Zr=An("poly",!0),$r=An("/*",!1),re=yn(["*","/"],!0,!1),ee=An("*/",!1),te=An("root inv",!0),ne=An("1st inv",!0),oe=An("2nd inv",!0),se=An("3rd inv",!0),ae=An("close harmony",!0),ue=An("close",!0),ce=An("drop2",!0),ie=An("drop-2",!0),le=An("open triad",!0),he=An("drop4",!0),fe=An("drop-4",!0),be=An("drop2and4",!0),pe=An("drop-2-and-4",!0),ve=An("no bass",!0),de=An("bass is root",!0),ge=An("bass plays root",!0),me=An("bass play root",!0),we=An("BPM",!0),Ae=An("TEMPO",!0),ye=yn([["0","9"]],!1,!1),Ce=An("|",!1),ke=An(" / ",!1),Le=An("key",!0),Ie=yn([" ","="],!1,!1),Re=yn([["A","G"]],!1,!1),xe=An("ionian",!0),Ee=An("dorian",!0),Oe=An("phrygian",!0),Se=An("lydian",!0),je=An("mixolydian",!0),Ve=An("aeolian",!0),Fe=An("locrian",!0),Qe=An("octave",!0),Me=yn([" ","-"],!1,!1),Pe=An("up",!0),qe=An("down",!0),Ne=An("VII",!1),De=An("III",!1),Je=An("VI",!1),Te=An("IV",!1),Be=An("II",!1),Ge=An("V",!1),Ue=An("I",!1),Ke=yn(["#","＃","♯"],!1,!1),_e=yn(["b","♭"],!1,!1),He=An("maj",!0),ze=An("M",!1),We=An("maj7",!0),Xe=An("M7",!1),Ye=An("△",!1),Ze=An("min",!0),$e=An("m",!1),rt=An("-",!1),et=An("min7",!0),tt=An("m7",!1),nt=An("-7",!1),ot=An("^",!1),st=yn([["0","3"]],!1,!1),at=Cn("whitespace"),ut=yn([" ","\t","\n","\r"],!1,!1),ct=Cn("hyphen"),it=An(" - ",!1),lt=An("→",!1),ht=An("Strings",!1),ft=An("Ensemble",!1),bt=An("1",!0),pt=An("1",!1),vt=An("Str.",!1),dt=An("2",!0),gt=An("2",!1),mt=An("Voice Aahs",!0),wt=An("Choir Aahs",!0),At=An("Choir",!0),yt=An("Chor.",!0),Ct=function(r){return r},kt=function(r,e,t){return{event:"chord",root:r,quality:e,inversion:t}},Lt=function(r,e,t,n,o,s){return{event:"slash chord",upperRoot:r,upperQuality:e,upperInversion:t,lowerRoot:n,lowerQuality:o,lowerInversion:s}},It=function(r,e,t,n,o,s){return{event:"chord over bass note",upperRoot:r,upperQuality:e,upperInversion:t,lowerRoot:n,lowerQuality:o,lowerInversion:s}},Rt=function(){return{event:"change slash chord mode to chord over bass note"}},xt=function(){return{event:"change slash chord mode to inversion"}},Et=function(){return{event:"change slash chord mode to polychord"}},Ot=function(r){return{event:"inline mml",mml:r.join("")}},St=function(){return{event:"change inversion mode to root inv"}},jt=function(){return{event:"change inversion mode to 1st inv"}},Vt=function(){return{event:"change inversion mode to 2nd inv"}},Ft=function(){return{event:"change inversion mode to 3rd inv"}},Qt=function(){return{event:"change open harmony mode to close"}},Mt=function(){return{event:"change open harmony mode to drop2"}},Pt=function(){return{event:"change open harmony mode to drop4"}},qt=function(){return{event:"change open harmony mode to drop2and4"}},Nt=function(){return{event:"change bass play mode to no bass"}},Dt=function(){return{event:"change bass play mode to root"}},Jt=function(r){return{event:"inline mml",mml:"t"+r.join("")}},Tt=function(){return{event:"bar"}},Bt=function(){return{event:"bar slash"}},Gt=function(r){return r},Ut=function(r,e,n){return Mn=t(r,e,n),{event:"key",root:r,sharpLength:e.length,flatLength:n.length,offset:Mn}},Kt=function(r){return Pn=r.toLowerCase(),{event:"scale",offsets:e(Pn)}},_t=function(){return{event:"octave up"}},Ht=function(){return{event:"octave up upper"}},zt=function(){return{event:"octave up lower"}},Wt=function(){return{event:"octave down"}},Xt=function(){return{event:"octave down upper"}},Yt=function(){return{event:"octave down lower"}},Zt=function(r,e,n){return t(r,e,n)},$t=function(r,t,n){let o=function(r,t){return e(r)[function(r){switch(r){case"I":return 0;case"II":return 1;case"III":return 2;case"IV":return 3;case"V":return 4;case"VI":return 5;case"VII":return 6;default:throw new Error("ERROR : getDegreeIndex")}}(t)]}(Pn,n);return o+=r.length-t.length+Mn,o},rn=function(){return"#"},en=function(){return"b"},tn=function(r){return r},nn=function(){return"maj"},on=function(){return"maj"},sn=function(){return"maj7"},an=function(){return"min"},un=function(){return"min"},cn=function(){return"min7"},ln=function(){switch(r.substring(vn,pn)){case"":return null;case"^0":return"root inv";case"^1":return"1st inv";case"^2":return"2nd inv";case"^3":return"3rd inv";default:throw new Error("ERROR : INVERSION")}},hn=function(){return{event:"inline mml",mml:"@48"}},fn=function(){return{event:"inline mml",mml:"@49"}},bn=function(){return{event:"inline mml",mml:"@52"}},pn=0,vn=0,dn=[{line:1,column:1}],gn=0,mn=[],wn=0;if("startRule"in o){if(!(o.startRule in c))throw new Error("Can't start parsing from rule \""+o.startRule+'".');i=c[o.startRule]}function An(r,e){return{type:"literal",text:r,ignoreCase:e}}function yn(r,e,t){return{type:"class",parts:r,inverted:e,ignoreCase:t}}function Cn(r){return{type:"other",description:r}}function kn(e){var t,n=dn[e];if(n)return n;for(t=e-1;!dn[t];)t--;for(n={line:(n=dn[t]).line,column:n.column};t<e;)10===r.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return dn[e]=n,n}function Ln(r,e,t){var n=kn(r),o=kn(e),s={source:u,start:{offset:r,line:n.line,column:n.column},end:{offset:e,line:o.line,column:o.column}};return t&&u&&"function"==typeof u.offset&&(s.start=u.offset(s.start),s.end=u.offset(s.end)),s}function In(r){pn<gn||(pn>gn&&(gn=pn,mn=[]),mn.push(r))}function Rn(){var r,e,t;for(r=pn,e=[],t=xn();t!==a;)e.push(t),t=xn();return t=Fn(),vn=r,Ct(e)}function xn(){var e;return(e=function(){var e,t,n,o;if(e=pn,r.substr(pn,2)===y?(t=y,pn+=2):(t=a,0===wn&&In($r)),t!==a){if(n=[],Vr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(re)),o!==a)for(;o!==a;)n.push(o),Vr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(re));else n=a;n!==a?(r.substr(pn,2)===C?(o=C,pn+=2):(o=a,0===wn&&In(ee)),o!==a?(vn=e,e=Ot(n)):(pn=e,e=a)):(pn=e,e=a)}else pn=e,e=a;return e}())===a&&(e=function(){var e,t;return e=pn,r.substr(pn,3)===G?(t=G,pn+=3):(t=a,0===wn&&In(ke)),t!==a?(Fn(),vn=e,e=Bt()):(pn=e,e=a),e}())===a&&(e=function(){var e;return(e=function(){var e,t,n,o,s,u,c;return e=pn,Fn(),t=pn,r.substr(pn,7)===Cr?(n=Cr,pn+=7):(n=a,0===wn&&In(ht)),n!==a?(o=Fn(),r.substr(pn,8)===kr?(s=kr,pn+=8):(s=a,0===wn&&In(ft)),s!==a?(u=Fn(),r.substr(pn,1).toLowerCase()===Lr?(c=r.charAt(pn),pn++):(c=a,0===wn&&In(bt)),c!==a?t=n=[n,o,s,u,c]:(pn=t,t=a)):(pn=t,t=a)):(pn=t,t=a),t===a&&(t=pn,r.substr(pn,7)===Cr?(n=Cr,pn+=7):(n=a,0===wn&&In(ht)),n!==a?(o=Fn(),49===r.charCodeAt(pn)?(s=Lr,pn++):(s=a,0===wn&&In(pt)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a),t===a&&(t=pn,r.substr(pn,4)===Ir?(n=Ir,pn+=4):(n=a,0===wn&&In(vt)),n!==a?(o=Fn(),49===r.charCodeAt(pn)?(s=Lr,pn++):(s=a,0===wn&&In(pt)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),o=Fn(),vn=e,e=hn()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s,u,c;return e=pn,Fn(),t=pn,r.substr(pn,7)===Cr?(n=Cr,pn+=7):(n=a,0===wn&&In(ht)),n!==a?(o=Fn(),r.substr(pn,8)===kr?(s=kr,pn+=8):(s=a,0===wn&&In(ft)),s!==a?(u=Fn(),r.substr(pn,1).toLowerCase()===Rr?(c=r.charAt(pn),pn++):(c=a,0===wn&&In(dt)),c!==a?t=n=[n,o,s,u,c]:(pn=t,t=a)):(pn=t,t=a)):(pn=t,t=a),t===a&&(t=pn,r.substr(pn,7)===Cr?(n=Cr,pn+=7):(n=a,0===wn&&In(ht)),n!==a?(o=Fn(),50===r.charCodeAt(pn)?(s=Rr,pn++):(s=a,0===wn&&In(gt)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a),t===a&&(t=pn,r.substr(pn,4)===Ir?(n=Ir,pn+=4):(n=a,0===wn&&In(vt)),n!==a?(o=Fn(),50===r.charCodeAt(pn)?(s=Rr,pn++):(s=a,0===wn&&In(gt)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),o=Fn(),vn=e,e=fn()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,10).toLowerCase()===xr?(t=r.substr(pn,10),pn+=10):(t=a,0===wn&&In(mt)),t===a&&(r.substr(pn,10).toLowerCase()===Er?(t=r.substr(pn,10),pn+=10):(t=a,0===wn&&In(wt)),t===a&&(r.substr(pn,5).toLowerCase()===Or?(t=r.substr(pn,5),pn+=5):(t=a,0===wn&&In(At)),t===a&&(r.substr(pn,5).toLowerCase()===Sr?(t=r.substr(pn,5),pn+=5):(t=a,0===wn&&In(yt))))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=bn()):(pn=e,e=a),e}()),e}())===a&&(e=function(){var e,t,n,o;if(e=pn,Fn(),r.substr(pn,3).toLowerCase()===J?(t=r.substr(pn,3),pn+=3):(t=a,0===wn&&In(we)),t===a&&(r.substr(pn,5).toLowerCase()===T?(t=r.substr(pn,5),pn+=5):(t=a,0===wn&&In(Ae))),t!==a){if(Fn(),n=[],Fr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(ye)),o!==a)for(;o!==a;)n.push(o),Fr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(ye));else n=a;n!==a?(jr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Kr)),o===a&&(o=null),Fn(),vn=e,e=Jt(n)):(pn=e,e=a)}else pn=e,e=a;return e}())===a&&(e=function(){var e,t,n,o,s;return e=pn,Fn(),t=pn,r.substr(pn,6).toLowerCase()===Z?(n=r.substr(pn,6),pn+=6):(n=a,0===wn&&In(Qe)),n!==a?(Pr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Me)),o!==a?(r.substr(pn,2).toLowerCase()===$?(s=r.substr(pn,2),pn+=2):(s=a,0===wn&&In(Pe)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a)):(pn=t,t=a),t!==a?(47===r.charCodeAt(pn)?(n=l,pn++):(n=a,0===wn&&In(Tr)),n!==a?(jr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Kr)),o===a&&(o=null),s=Fn(),vn=e,e=Ht()):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s;return e=pn,Fn(),t=pn,r.substr(pn,6).toLowerCase()===Z?(n=r.substr(pn,6),pn+=6):(n=a,0===wn&&In(Qe)),n!==a?(Pr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Me)),o!==a?(r.substr(pn,4).toLowerCase()===rr?(s=r.substr(pn,4),pn+=4):(s=a,0===wn&&In(qe)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a)):(pn=t,t=a),t!==a?(47===r.charCodeAt(pn)?(n=l,pn++):(n=a,0===wn&&In(Tr)),n!==a?(jr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Kr)),o===a&&(o=null),s=Fn(),vn=e,e=Xt()):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s,u;return e=pn,Fn(),47===r.charCodeAt(pn)?(t=l,pn++):(t=a,0===wn&&In(Tr)),t!==a?(n=pn,r.substr(pn,6).toLowerCase()===Z?(o=r.substr(pn,6),pn+=6):(o=a,0===wn&&In(Qe)),o!==a?(Pr.test(r.charAt(pn))?(s=r.charAt(pn),pn++):(s=a,0===wn&&In(Me)),s!==a?(r.substr(pn,2).toLowerCase()===$?(u=r.substr(pn,2),pn+=2):(u=a,0===wn&&In(Pe)),u!==a?n=o=[o,s,u]:(pn=n,n=a)):(pn=n,n=a)):(pn=n,n=a),n!==a?(jr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Kr)),o===a&&(o=null),s=Fn(),vn=e,e=zt()):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s,u;return e=pn,Fn(),47===r.charCodeAt(pn)?(t=l,pn++):(t=a,0===wn&&In(Tr)),t!==a?(n=pn,r.substr(pn,6).toLowerCase()===Z?(o=r.substr(pn,6),pn+=6):(o=a,0===wn&&In(Qe)),o!==a?(Pr.test(r.charAt(pn))?(s=r.charAt(pn),pn++):(s=a,0===wn&&In(Me)),s!==a?(r.substr(pn,4).toLowerCase()===rr?(u=r.substr(pn,4),pn+=4):(u=a,0===wn&&In(qe)),u!==a?n=o=[o,s,u]:(pn=n,n=a)):(pn=n,n=a)):(pn=n,n=a),n!==a?(jr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Kr)),o===a&&(o=null),s=Fn(),vn=e,e=Yt()):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s;return e=pn,Fn(),t=pn,r.substr(pn,6).toLowerCase()===Z?(n=r.substr(pn,6),pn+=6):(n=a,0===wn&&In(Qe)),n!==a?(Pr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Me)),o!==a?(r.substr(pn,2).toLowerCase()===$?(s=r.substr(pn,2),pn+=2):(s=a,0===wn&&In(Pe)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a)):(pn=t,t=a),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),o=Fn(),vn=e,e=_t()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s;return e=pn,Fn(),t=pn,r.substr(pn,6).toLowerCase()===Z?(n=r.substr(pn,6),pn+=6):(n=a,0===wn&&In(Qe)),n!==a?(Pr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(Me)),o!==a?(r.substr(pn,4).toLowerCase()===rr?(s=r.substr(pn,4),pn+=4):(s=a,0===wn&&In(qe)),s!==a?t=n=[n,o,s]:(pn=t,t=a)):(pn=t,t=a)):(pn=t,t=a),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),o=Fn(),vn=e,e=Wt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,20).toLowerCase()===b?(t=r.substr(pn,20),pn+=20):(t=a,0===wn&&In(Ur)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),vn=e,e=Rt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,21).toLowerCase()===v?(t=r.substr(pn,21),pn+=21):(t=a,0===wn&&In(Hr)),t===a&&(r.substr(pn,15).toLowerCase()===d?(t=r.substr(pn,15),pn+=15):(t=a,0===wn&&In(zr)),t===a&&(r.substr(pn,3).toLowerCase()===g?(t=r.substr(pn,3),pn+=3):(t=a,0===wn&&In(Wr)),t===a&&(r.substr(pn,2).toLowerCase()===m?(t=r.substr(pn,2),pn+=2):(t=a,0===wn&&In(Xr)),t===a&&(r.substr(pn,9).toLowerCase()===w?(t=r.substr(pn,9),pn+=9):(t=a,0===wn&&In(Yr)),t===a&&(r.substr(pn,4).toLowerCase()===A?(t=r.substr(pn,4),pn+=4):(t=a,0===wn&&In(Zr))))))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),vn=e,e=Et()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,21).toLowerCase()===p?(t=r.substr(pn,21),pn+=21):(t=a,0===wn&&In(_r)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),vn=e,e=xt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s,u,c,i;return e=pn,Fn(),(t=En())!==a&&(n=jn())!==a?(o=Vn(),47===r.charCodeAt(pn)?(s=l,pn++):(s=a,0===wn&&In(Tr)),s!==a&&(u=En())!==a&&(c=jn())!==a?(i=Vn(),Qn(),vn=e,e=Lt(t,n,o,u,c,i)):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s,u,c,i;return e=pn,Fn(),(t=En())!==a&&(n=jn())!==a?(o=Vn(),r.substr(pn,2)===h?(s=h,pn+=2):(s=a,0===wn&&In(Br)),s===a&&(r.substr(pn,4)===f?(s=f,pn+=4):(s=a,0===wn&&In(Gr))),s!==a&&(u=En())!==a&&(c=jn())!==a?(i=Vn(),Qn(),vn=e,e=It(t,n,o,u,c,i)):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,8).toLowerCase()===k?(t=r.substr(pn,8),pn+=8):(t=a,0===wn&&In(te)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=St()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,7).toLowerCase()===L?(t=r.substr(pn,7),pn+=7):(t=a,0===wn&&In(ne)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=jt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,7).toLowerCase()===I?(t=r.substr(pn,7),pn+=7):(t=a,0===wn&&In(oe)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Vt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,7).toLowerCase()===R?(t=r.substr(pn,7),pn+=7):(t=a,0===wn&&In(se)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Ft()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,9).toLowerCase()===Q?(t=r.substr(pn,9),pn+=9):(t=a,0===wn&&In(be)),t===a&&(r.substr(pn,12).toLowerCase()===M?(t=r.substr(pn,12),pn+=12):(t=a,0===wn&&In(pe))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=qt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,5).toLowerCase()===V?(t=r.substr(pn,5),pn+=5):(t=a,0===wn&&In(he)),t===a&&(r.substr(pn,6).toLowerCase()===F?(t=r.substr(pn,6),pn+=6):(t=a,0===wn&&In(fe))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Pt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,5).toLowerCase()===O?(t=r.substr(pn,5),pn+=5):(t=a,0===wn&&In(ce)),t===a&&(r.substr(pn,6).toLowerCase()===S?(t=r.substr(pn,6),pn+=6):(t=a,0===wn&&In(ie)),t===a&&(r.substr(pn,10).toLowerCase()===j?(t=r.substr(pn,10),pn+=10):(t=a,0===wn&&In(le)))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Mt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,13).toLowerCase()===x?(t=r.substr(pn,13),pn+=13):(t=a,0===wn&&In(ae)),t===a&&(r.substr(pn,5).toLowerCase()===E?(t=r.substr(pn,5),pn+=5):(t=a,0===wn&&In(ue))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Qt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,7).toLowerCase()===P?(t=r.substr(pn,7),pn+=7):(t=a,0===wn&&In(ve)),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Nt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,12).toLowerCase()===q?(t=r.substr(pn,12),pn+=12):(t=a,0===wn&&In(de)),t===a&&(r.substr(pn,15).toLowerCase()===N?(t=r.substr(pn,15),pn+=15):(t=a,0===wn&&In(ge)),t===a&&(r.substr(pn,14).toLowerCase()===D?(t=r.substr(pn,14),pn+=14):(t=a,0===wn&&In(me)))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Dt()):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n;return e=pn,Fn(),r.substr(pn,6).toLowerCase()===K?(t=r.substr(pn,6),pn+=6):(t=a,0===wn&&In(xe)),t===a&&(r.substr(pn,6).toLowerCase()===_?(t=r.substr(pn,6),pn+=6):(t=a,0===wn&&In(Ee)),t===a&&(r.substr(pn,8).toLowerCase()===H?(t=r.substr(pn,8),pn+=8):(t=a,0===wn&&In(Oe)),t===a&&(r.substr(pn,6).toLowerCase()===z?(t=r.substr(pn,6),pn+=6):(t=a,0===wn&&In(Se)),t===a&&(r.substr(pn,10).toLowerCase()===W?(t=r.substr(pn,10),pn+=10):(t=a,0===wn&&In(je)),t===a&&(r.substr(pn,7).toLowerCase()===X?(t=r.substr(pn,7),pn+=7):(t=a,0===wn&&In(Ve)),t===a&&(r.substr(pn,7).toLowerCase()===Y?(t=r.substr(pn,7),pn+=7):(t=a,0===wn&&In(Fe)))))))),t!==a?(jr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Kr)),n===a&&(n=null),Fn(),vn=e,e=Kt(t)):(pn=e,e=a),e}())===a&&(e=function(){var e,t,n,o,s;return e=pn,Fn(),r.substr(pn,3).toLowerCase()===U?(t=r.substr(pn,3),pn+=3):(t=a,0===wn&&In(Le)),t!==a?(Qr.test(r.charAt(pn))?(n=r.charAt(pn),pn++):(n=a,0===wn&&In(Ie)),n===a&&(n=null),o=function(){var e,t,n,o,s;if(e=pn,Mr.test(r.charAt(pn))?(t=r.charAt(pn),pn++):(t=a,0===wn&&In(Re)),t!==a){for(n=[],o=On();o!==a;)n.push(o),o=On();for(o=[],s=Sn();s!==a;)o.push(s),s=Sn();vn=e,e=Ut(t,n,o)}else pn=e,e=a;return e}(),o!==a?(jr.test(r.charAt(pn))?(s=r.charAt(pn),pn++):(s=a,0===wn&&In(Kr)),s===a&&(s=null),Fn(),vn=e,e=Gt(o)):(pn=e,e=a)):(pn=e,e=a),e}())===a&&(e=function(){var r,e,t,n;return r=pn,Fn(),(e=En())!==a&&(t=jn())!==a?(n=Vn(),Qn(),vn=r,r=kt(e,t,n)):(pn=r,r=a),r}())===a&&(e=function(){var e,t;return e=pn,Fn(),124===r.charCodeAt(pn)?(t=B,pn++):(t=a,0===wn&&In(Ce)),t!==a?(Fn(),vn=e,e=Tt()):(pn=e,e=a),e}()),e}function En(){var e;return(e=function(){var e,t,n,o,s;if(e=pn,Mr.test(r.charAt(pn))?(t=r.charAt(pn),pn++):(t=a,0===wn&&In(Re)),t!==a){for(n=[],o=On();o!==a;)n.push(o),o=On();for(o=[],s=Sn();s!==a;)o.push(s),s=Sn();vn=e,e=Zt(t,n,o)}else pn=e,e=a;return e}())===a&&(e=function(){var e,t,n,o;for(e=pn,t=[],n=On();n!==a;)t.push(n),n=On();for(n=[],o=Sn();o!==a;)n.push(o),o=Sn();return r.substr(pn,3)===er?(o=er,pn+=3):(o=a,0===wn&&In(Ne)),o===a&&(r.substr(pn,3)===tr?(o=tr,pn+=3):(o=a,0===wn&&In(De)),o===a&&(r.substr(pn,2)===nr?(o=nr,pn+=2):(o=a,0===wn&&In(Je)),o===a&&(r.substr(pn,2)===or?(o=or,pn+=2):(o=a,0===wn&&In(Te)),o===a&&(r.substr(pn,2)===sr?(o=sr,pn+=2):(o=a,0===wn&&In(Be)),o===a&&(86===r.charCodeAt(pn)?(o=ar,pn++):(o=a,0===wn&&In(Ge)),o===a&&(73===r.charCodeAt(pn)?(o=ur,pn++):(o=a,0===wn&&In(Ue)))))))),o!==a?(vn=e,e=$t(t,n,o)):(pn=e,e=a),e}()),e}function On(){var e,t;return e=pn,qr.test(r.charAt(pn))?(t=r.charAt(pn),pn++):(t=a,0===wn&&In(Ke)),t!==a&&(vn=e,t=rn()),t}function Sn(){var e,t;return e=pn,Nr.test(r.charAt(pn))?(t=r.charAt(pn),pn++):(t=a,0===wn&&In(_e)),t!==a&&(vn=e,t=en()),t}function jn(){var e,t;return e=pn,t=function(){var e,t;return e=pn,r.substr(pn,4).toLowerCase()===dr?(t=r.substr(pn,4),pn+=4):(t=a,0===wn&&In(et)),t===a&&(r.substr(pn,2)===gr?(t=gr,pn+=2):(t=a,0===wn&&In(tt)),t===a&&(r.substr(pn,2)===mr?(t=mr,pn+=2):(t=a,0===wn&&In(nt)))),t!==a&&(vn=e,t=cn()),e=t}(),t===a&&(t=function(){var e,t;return e=pn,r.substr(pn,4).toLowerCase()===lr?(t=r.substr(pn,4),pn+=4):(t=a,0===wn&&In(We)),t===a&&(r.substr(pn,2)===hr?(t=hr,pn+=2):(t=a,0===wn&&In(Xe)),t===a&&(9651===r.charCodeAt(pn)?(t=fr,pn++):(t=a,0===wn&&In(Ye)))),t!==a&&(vn=e,t=sn()),e=t}(),t===a&&(t=function(){var e,t;return e=pn,r.substr(pn,3).toLowerCase()===cr?(t=r.substr(pn,3),pn+=3):(t=a,0===wn&&In(He)),t!==a&&(vn=e,t=nn()),e=t}(),t===a&&(t=function(){var e,t;return e=pn,r.substr(pn,3).toLowerCase()===br?(t=r.substr(pn,3),pn+=3):(t=a,0===wn&&In(Ze)),t!==a&&(vn=e,t=an()),e=t}(),t===a&&(t=function(){var e,t;return e=pn,109===r.charCodeAt(pn)?(t=pr,pn++):(t=a,0===wn&&In($e)),t===a&&(45===r.charCodeAt(pn)?(t=vr,pn++):(t=a,0===wn&&In(rt))),t!==a&&(vn=e,t=un()),e=t}(),t===a&&(t=function(){var e,t;return e=pn,77===r.charCodeAt(pn)?(t=ir,pn++):(t=a,0===wn&&In(ze)),t===a&&(t=""),t!==a&&(vn=e,t=on()),e=t}()))))),t!==a&&(vn=e,t=tn(t)),t}function Vn(){var e,t,n,o;return e=pn,t=pn,94===r.charCodeAt(pn)?(n=wr,pn++):(n=a,0===wn&&In(ot)),n!==a?(Dr.test(r.charAt(pn))?(o=r.charAt(pn),pn++):(o=a,0===wn&&In(st)),o!==a?t=n=[n,o]:(pn=t,t=a)):(pn=t,t=a),t===a&&(t=null),vn=e,ln()}function Fn(){var e,t;for(wn++,e=[],Jr.test(r.charAt(pn))?(t=r.charAt(pn),pn++):(t=a,0===wn&&In(ut));t!==a;)e.push(t),Jr.test(r.charAt(pn))?(t=r.charAt(pn),pn++):(t=a,0===wn&&In(ut));return wn--,t=a,0===wn&&In(at),e}function Qn(){var e,t,n,o;for(wn++,e=[],r.substr(pn,3)===Ar?(t=Ar,pn+=3):(t=a,0===wn&&In(it)),t===a&&(t=pn,n=Fn(),8594===r.charCodeAt(pn)?(o=yr,pn++):(o=a,0===wn&&In(lt)),o!==a?t=n=[n,o,Fn()]:(pn=t,t=a));t!==a;)e.push(t),r.substr(pn,3)===Ar?(t=Ar,pn+=3):(t=a,0===wn&&In(it)),t===a&&(t=pn,n=Fn(),8594===r.charCodeAt(pn)?(o=yr,pn++):(o=a,0===wn&&In(lt)),o!==a?t=n=[n,o,Fn()]:(pn=t,t=a));return wn--,t=a,0===wn&&In(ct),e}let Mn=0,Pn="ionian";if((s=i())!==a&&pn===r.length)return s;throw s!==a&&pn<r.length&&In({type:"end"}),qn=mn,Nn=gn<r.length?r.charAt(gn):null,Dn=gn<r.length?Ln(gn,gn+1):Ln(gn,gn),new n(n.buildMessage(qn,Nn),qn,Nn,Dn);var qn,Nn,Dn}}}},e={};function t(n){var o=e[n];if(void 0!==o)return o.exports;var s=e[n]={exports:{}};return r[n](s,s.exports,t),s.exports}t.d=(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},t.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),t.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var n={};return(()=>{t.r(n),t.d(n,{chord2mml:()=>g});var r=t(699);function e(r,e,t){for(var n=e.length*t,o=0,s=e;o<s.length;o++)r[s[o]].noteLength=n;return r}var o=function(r,e,t){if(t||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};function s(r){return delete r.event,delete r.root,delete r.quality,delete r.inversion,delete r.upperRoot,delete r.upperQuality,delete r.upperInversion,delete r.lowerRoot,delete r.lowerQuality,delete r.lowerInversion,r}function a(r,e,t,n,o){var s=[];switch(e){case"maj":s=[0,4,7];break;case"maj7":s=[0,4,7,11];break;case"min":s=[0,3,7];break;case"min7":s=[0,3,7,10]}return s=c(s,r),c(s=u(s,t,n),12*o)}function u(r,e,t){switch(e){case"1st inv":r=b(r,1);break;case"2nd inv":r=b(r,2);break;case"3rd inv":r=b(r,3)}switch(t){case"drop2":r=function(r){if(r.length<2)return r;var e=r[r.length-2]-12;return r.splice(r.length-2,1),r.unshift(e),r}(r);break;case"drop4":r=function(r){if(r.length<4)return r;var e=r[r.length-4]-12;return r.splice(r.length-4,1),r.unshift(e),r}(r);break;case"drop2and4":r=function(r){if(r.length<4)return r;var e=r[r.length-2]-12,t=r[r.length-4]-12;return r.splice(r.length-2,1),r.splice(r.length-4+1,1),r.unshift(e),r.unshift(t),r}(r)}return r}function c(r,e){for(var t=0;t<r.length;t++)r[t]+=e;return r}function i(r,e,t,n,o,s,a){var c=[];c.push(t+12*a);var i=l(r,e,t,s);return i=u(i,n,o),c.push.apply(c,i),c}function l(r,e,t,n){var o=a(r,e,"root inv","close",n);return r<=t&&(o=c(o,12)),o}function h(r,e,t,n,o){var s=[];if("root"==n){s.push(r);var u=l(r,e,r,o);u=f(u,t),s.push.apply(s,u),s=c(s,-12)}else s=f(s=a(r,e,"root inv","close",o),t);return s}function f(r,e){for(var t=!1,n=0,o=r;n<o.length;n++){if(o[n],(r[0]%12+12)%12==(e%12+12)%12){t=!0;break}r.push(r.shift())}if(t)return p(r);throw new Error("ERROR : ".concat(JSON.stringify(r)," を転回しようとしましたが、chordに ").concat(JSON.stringify(e)," が含まれていません。chordに含まれるnoteを指定してください。"))}function b(r,e){for(var t=0;t<e;t++)r.push(r.shift());return p(r)}function p(r){for(var e=-1,t=0;t<r.length;t++){for(var n=0;n<128&&!(r[t]>e);n+=12)r[t]+=12;e=r[t]}return r}function v(r,e,t,n,s,u,c,i){var l=a(r,e,t,"close",c),h=a(n,s,u,"close",i),f=o(o([],h,!0),l,!0);return p(f)}function d(r,e,t){var n=function(r,e,t){for(var n=e.map((function(e){return e+r})).map((function(r){return r%12})).sort((function(r,e){return r-e})),o=0;o<t.length;o++)if(JSON.stringify(t[o])===JSON.stringify(n))return o;throw new Error("ERROR : isKeySharp searchArrays")}(r,e,t);switch(n){case 0:case 2:case 4:case 7:case 9:case 11:return!0;case 1:case 3:case 5:case 6:case 8:case 10:return!1;default:throw new Error("ERROR : isKeySharp")}}var g={parse:r.parse};g.parse=function(t){var n=(0,r.parse)(t);return function(r){for(var e=function(r){for(var e=[],t=function(t){var n=r.map((function(r){return(r+t)%12}));e.push(n)},n=0;n<12;n++)t(n);return e}([0,2,4,5,7,9,11]).map((function(r){return r.sort((function(r,e){return r-e}))})),t="",n={event:"key",root:"C",sharpLength:0,flatLength:0,offset:0},o={event:"scale",offsets:[0,2,4,5,7,9,11]},s=d(n.offset,o.offsets,e),a=0,u=r;a<u.length;a++){var c=u[a];switch(c.event){case"inline mml":t+=c.mml;continue;case"bar":t+="/*|*/";continue;case"key":s=d((n=c).offset,o.offsets,e);continue;case"scale":o=c,s=d(n.offset,o.offsets,e);continue}var i=c.notes;if(i){var l=0;i.length&&(t+="'");for(var h=i[0];h<0;)h+=12,t+=">",l--;for(var f=0;f<i.length;f++){for(var b=i[f],p=Math.floor(b/12);p>l;)t+="<",l++;if(s)switch((b%12+12)%12){case 0:t+="c";break;case 1:t+="c+";break;case 2:t+="d";break;case 3:t+="d+";break;case 4:t+="e";break;case 5:t+="f";break;case 6:t+="f+";break;case 7:t+="g";break;case 8:t+="g+";break;case 9:t+="a";break;case 10:t+="a+";break;case 11:t+="b"}else switch((b%12+12)%12){case 0:t+="c";break;case 1:t+="d-";break;case 2:t+="d";break;case 3:t+="e-";break;case 4:t+="e";break;case 5:t+="f";break;case 6:t+="g-";break;case 7:t+="g";break;case 8:t+="a-";break;case 9:t+="a";break;case 10:t+="b-";break;case 11:t+="b"}!f&&c.noteLength&&(t+=c.noteLength)}i.length&&(t+="'")}}return t}(function(r){for(var e,t,n,o,u=[],l="root inv",f="close",b="no bass",p=0,d=0,g=0,m=r;g<m.length;g++){var w=m[g];switch(w.event){case"chord":w.notes=a(w.root,w.quality,null!==(e=w.inversion)&&void 0!==e?e:l,f,p),w=s(w),u.push(w);break;case"chord over bass note":w.notes=i(w.upperRoot,w.upperQuality,w.lowerRoot,null!==(t=w.upperInversion)&&void 0!==t?t:l,f,p,d),w.notes=c(w.notes,-12),w=s(w),u.push(w);break;case"inversion":w.notes=h(w.upperRoot,w.upperQuality,w.lowerRoot,b,p),w=s(w),u.push(w);break;case"polychord":w.notes=v(w.upperRoot,w.upperQuality,null!==(n=w.upperInversion)&&void 0!==n?n:l,w.lowerRoot,w.lowerQuality,null!==(o=w.lowerInversion)&&void 0!==o?o:l,p,d),w=s(w),u.push(w);break;case"change inversion mode to root inv":l="root inv";break;case"change inversion mode to 1st inv":l="1st inv";break;case"change inversion mode to 2nd inv":l="2nd inv";break;case"change inversion mode to 3rd inv":l="3rd inv";break;case"change open harmony mode to close":f="close";break;case"change open harmony mode to drop2":f="drop2";break;case"change open harmony mode to drop4":f="drop4";break;case"change open harmony mode to drop2and4":f="drop2and4";break;case"change bass play mode to root":b="root";break;case"change bass play mode to no bass":b="no bass";break;case"octave up":p++,d++;break;case"octave up upper":p++;break;case"octave up lower":d++;break;case"octave down":p--,d--;break;case"octave down upper":p--;break;case"octave down lower":d--;break;default:u.push(w)}}return u}(n=function(r){for(var t="chord over bass note",n="no bass",o=0,s=r;o<s.length;o++){var a=s[o];switch(a.event){case"change slash chord mode to chord over bass note":t="chord over bass note";break;case"change slash chord mode to inversion":t="inversion";break;case"change slash chord mode to polychord":t="polychord";break;case"slash chord":a.event=t;break;case"change bass play mode to root":n="root";break;case"change bass play mode to no bass":n="no bass";break;case"chord":"root"==n&&(a.event="chord over bass note",a.upperRoot=a.root,a.upperQuality=a.quality,a.upperInversion=a.inversion,a.lowerRoot=a.root,a.lowerQuality=a.quality,a.lowerInversion=a.inversion,delete a.root,delete a.quality,delete a.inversion)}}return r=function(r){for(var t=0,n=1,o=[],s=0;s<r.length;s++){var a=r[s];switch(a.event){case"chord":case"chord over bass note":case"inversion":case"polychord":a.noteLength=1,o.push(s);break;case"bar":t++,r=e(r,o,n),o=[],n=1;break;case"bar slash":t++,r=e(r,o,n=2),o=[]}}return t&&(r=e(r,o,n)),r}(r),r}(n)))}})(),n})()));