!function(r,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t=e();for(var n in t)("object"==typeof exports?exports:r)[n]=t[n]}}(self,(()=>(()=>{"use strict";var r={699:r=>{function e(r,t,n,o){var s=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(s,e.prototype),s.expected=t,s.found=n,s.location=o,s.name="SyntaxError",s}function t(r,e,t){return t=t||" ",r.length>e?r:(e-=r.length,r+(t+=t.repeat(e)).slice(0,e))}!function(r,e){function t(){this.constructor=r}t.prototype=e.prototype,r.prototype=new t}(e,Error),e.prototype.format=function(r){var e="Error: "+this.message;if(this.location){var n,o=null;for(n=0;n<r.length;n++)if(r[n].source===this.location.source){o=r[n].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,a=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,u=this.location.source+":"+a.line+":"+a.column;if(o){var c=this.location.end,i=t("",a.line.toString().length," "),l=o[s.line-1],h=(s.line===c.line?c.column:l.length+1)-s.column||1;e+="\n --\x3e "+u+"\n"+i+" |\n"+a.line+" | "+l+"\n"+i+" | "+t("",s.column-1," ")+t("",h,"^")}else e+="\n at "+u}return e},e.buildMessage=function(r,e){var t={literal:function(r){return'"'+o(r.text)+'"'},class:function(r){var e=r.parts.map((function(r){return Array.isArray(r)?s(r[0])+"-"+s(r[1]):s(r)}));return"["+(r.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function o(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function s(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function a(r){return t[r.type](r)}return"Expected "+function(r){var e,t,n=r.map(a);if(n.sort(),n.length>0){for(e=1,t=1;e<n.length;e++)n[e-1]!==n[e]&&(n[t]=n[e],t++);n.length=t}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(r)+" but "+function(r){return r?'"'+o(r)+'"':"end of input"}(e)+" found."},r.exports={SyntaxError:e,parse:function(r,t){var n,o={},s=(t=void 0!==t?t:{}).grammarSource,a={CHORDS:an},u=an,c="/",i="on",l="chord over bass note",h="slash chord inversion",f="upper structure triad",b="upper structure",p="ust",v="us",d="polychord",g="poly",m="/*",w="*/",y="root inv",I="1st inv",A="2nd inv",C="3rd inv",R="close harmony",k="close",L="drop2",V="drop-2",x="open triad",E="drop4",O="drop-4",S="drop2and4",j="drop-2-and-4",F="no bass",Q="bass is root",B="bass plays root",M="bass play root",P="bpm",q="tempo",T="|",D=" / ",G="key",N="ionian",U="dorian",_="phrygian",J="lydian",H="mixolydian",z="aeolian",K="locrian",W="VII",X="III",Y="VI",Z="IV",$="II",rr="V",er="I",tr="maj",nr="M",or="maj7",sr="M7",ar="△",ur="min",cr="m",ir="-",lr="min7",hr="m7",fr="-7",br="^",pr=" - ",vr="→",dr="Strings",gr="Ensemble",mr="1",wr="Str.",yr="2",Ir="voice aahs",Ar="choir aahs",Cr="choir",Rr="chor.",kr=/^[,.]/,Lr=/^[^*\/]/,Vr=/^[0-9]/,xr=/^[ =]/,Er=/^[A-G]/,Or=/^[#\uFF03\u266F]/,Sr=/^[b\u266D]/,jr=/^[0-3]/,Fr=/^[ \t\n\r]/,Qr=rn("/",!1),Br=rn("on",!1),Mr=rn("chord over bass note",!0),Pr=en([",","."],!1,!1),qr=rn("slash chord inversion",!0),Tr=rn("upper structure triad",!0),Dr=rn("upper structure",!0),Gr=rn("UST",!0),Nr=rn("US",!0),Ur=rn("polychord",!0),_r=rn("poly",!0),Jr=rn("/*",!1),Hr=en(["*","/"],!0,!1),zr=rn("*/",!1),Kr=rn("root inv",!0),Wr=rn("1st inv",!0),Xr=rn("2nd inv",!0),Yr=rn("3rd inv",!0),Zr=rn("close harmony",!0),$r=rn("close",!0),re=rn("drop2",!0),ee=rn("drop-2",!0),te=rn("open triad",!0),ne=rn("drop4",!0),oe=rn("drop-4",!0),se=rn("drop2and4",!0),ae=rn("drop-2-and-4",!0),ue=rn("no bass",!0),ce=rn("bass is root",!0),ie=rn("bass plays root",!0),le=rn("bass play root",!0),he=rn("BPM",!0),fe=rn("TEMPO",!0),be=en([["0","9"]],!1,!1),pe=rn("|",!1),ve=rn(" / ",!1),de=rn("key",!0),ge=en([" ","="],!1,!1),me=rn("ionian",!0),we=rn("dorian",!0),ye=rn("phrygian",!0),Ie=rn("lydian",!0),Ae=rn("mixolydian",!0),Ce=rn("aeolian",!0),Re=rn("locrian",!0),ke=en([["A","G"]],!1,!1),Le=rn("VII",!1),Ve=rn("III",!1),xe=rn("VI",!1),Ee=rn("IV",!1),Oe=rn("II",!1),Se=rn("V",!1),je=rn("I",!1),Fe=en(["#","＃","♯"],!1,!1),Qe=en(["b","♭"],!1,!1),Be=rn("maj",!0),Me=rn("M",!1),Pe=rn("maj7",!0),qe=rn("M7",!1),Te=rn("△",!1),De=rn("min",!0),Ge=rn("m",!1),Ne=rn("-",!1),Ue=rn("min7",!0),_e=rn("m7",!1),Je=rn("-7",!1),He=rn("^",!1),ze=en([["0","3"]],!1,!1),Ke=tn("whitespace"),We=en([" ","\t","\n","\r"],!1,!1),Xe=tn("hyphen"),Ye=rn(" - ",!1),Ze=rn("→",!1),$e=rn("Strings",!1),rt=rn("Ensemble",!1),et=rn("1",!0),tt=rn("1",!1),nt=rn("Str.",!1),ot=rn("2",!0),st=rn("2",!1),at=rn("Voice Aahs",!0),ut=rn("Choir Aahs",!0),ct=rn("Choir",!0),it=rn("Chor.",!0),lt=function(r){return r},ht=function(r,e,t){return{event:"chord",root:r,quality:e,inversion:t}},ft=function(r,e,t,n,o,s){return{event:"slash chord",upperRoot:r,upperQuality:e,upperInversion:t,lowerRoot:n,lowerQuality:o,lowerInversion:s}},bt=function(r,e,t,n,o,s){return{event:"chord over bass note",upperRoot:r,upperQuality:e,upperInversion:t,lowerRoot:n,lowerQuality:o,lowerInversion:s}},pt=function(){return{event:"change slash chord mode to chord over bass note"}},vt=function(){return{event:"change slash chord mode to inversion"}},dt=function(){return{event:"change slash chord mode to polychord"}},gt=function(r){return{event:"inline mml",mml:r.join("")}},mt=function(){return{event:"change inversion mode to root inv"}},wt=function(){return{event:"change inversion mode to 1st inv"}},yt=function(){return{event:"change inversion mode to 2nd inv"}},It=function(){return{event:"change inversion mode to 3rd inv"}},At=function(){return{event:"change open harmony mode to close"}},Ct=function(){return{event:"change open harmony mode to drop2"}},Rt=function(){return{event:"change open harmony mode to drop4"}},kt=function(){return{event:"change open harmony mode to drop2and4"}},Lt=function(){return{event:"change bass play mode to no bass"}},Vt=function(){return{event:"change bass play mode to root"}},xt=function(r){return{event:"inline mml",mml:"t"+r.join("")}},Et=function(){return{event:"bar"}},Ot=function(){return{event:"bar slash"}},St=function(r){return gn=r,{event:""}},jt=function(r){return mn=r.toLowerCase(),{event:""}},Ft=function(r,e,t){let n;switch(r){case"C":n=0;break;case"D":n=2;break;case"E":n=4;break;case"F":n=5;break;case"G":n=7;break;case"A":n=9;break;case"B":n=11;break;default:throw new Error("ERROR : ROOT_CDEFGAB")}return n+=e.length-t.length,n},Qt=function(r,e,t){let n=function(r,e){switch(r){case"ionian":switch(e){case"I":return 0;case"II":return 2;case"III":return 4;case"IV":return 5;case"V":return 7;case"VI":return 9;case"VII":return 11;default:throw new Error("ERROR : getOffsetByScale")}case"dorian":switch(e){case"I":return 0;case"II":return 2;case"III":return 3;case"IV":return 5;case"V":return 7;case"VI":return 9;case"VII":return 10;default:throw new Error("ERROR : getOffsetByScale")}case"phrygian":switch(e){case"I":return 0;case"II":return 1;case"III":return 3;case"IV":return 5;case"V":return 7;case"VI":return 8;case"VII":return 10;default:throw new Error("ERROR : getOffsetByScale")}case"lydian":switch(e){case"I":return 0;case"II":return 2;case"III":return 4;case"IV":return 6;case"V":return 7;case"VI":return 9;case"VII":return 11;default:throw new Error("ERROR : getOffsetByScale")}case"mixolydian":switch(e){case"I":return 0;case"II":return 2;case"III":return 4;case"IV":return 5;case"V":return 7;case"VI":return 9;case"VII":return 10;default:throw new Error("ERROR : getOffsetByScale")}case"aeolian":switch(e){case"I":return 0;case"II":return 1;case"III":return 3;case"IV":return 5;case"V":return 7;case"VI":return 8;case"VII":return 10;default:throw new Error("ERROR : getOffsetByScale")}case"locrian":switch(e){case"I":return 0;case"II":return 1;case"III":return 3;case"IV":return 5;case"V":return 6;case"VI":return 8;case"VII":return 10;default:throw new Error("ERROR : getOffsetByScale")}default:throw new Error("ERROR : getOffsetByScale")}}(mn,t);return n+=r.length-e.length+gn,n},Bt=function(){return"#"},Mt=function(){return"b"},Pt=function(r){return r},qt=function(){return"maj"},Tt=function(){return"maj"},Dt=function(){return"maj7"},Gt=function(){return"min"},Nt=function(){return"min"},Ut=function(){return"min7"},_t=function(){switch(r.substring(Wt,Kt)){case"":return null;case"^0":return"root inv";case"^1":return"1st inv";case"^2":return"2nd inv";case"^3":return"3rd inv";default:throw new Error("ERROR : INVERSION")}},Jt=function(){return{event:"inline mml",mml:"@48"}},Ht=function(){return{event:"inline mml",mml:"@49"}},zt=function(){return{event:"inline mml",mml:"@52"}},Kt=0,Wt=0,Xt=[{line:1,column:1}],Yt=0,Zt=[],$t=0;if("startRule"in t){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');u=a[t.startRule]}function rn(r,e){return{type:"literal",text:r,ignoreCase:e}}function en(r,e,t){return{type:"class",parts:r,inverted:e,ignoreCase:t}}function tn(r){return{type:"other",description:r}}function nn(e){var t,n=Xt[e];if(n)return n;for(t=e-1;!Xt[t];)t--;for(n={line:(n=Xt[t]).line,column:n.column};t<e;)10===r.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return Xt[e]=n,n}function on(r,e,t){var n=nn(r),o=nn(e),a={source:s,start:{offset:r,line:n.line,column:n.column},end:{offset:e,line:o.line,column:o.column}};return t&&s&&"function"==typeof s.offset&&(a.start=s.offset(a.start),a.end=s.offset(a.end)),a}function sn(r){Kt<Yt||(Kt>Yt&&(Yt=Kt,Zt=[]),Zt.push(r))}function an(){var r,e,t;for(r=Kt,e=[],t=un();t!==o;)e.push(t),t=un();return t=vn(),Wt=r,lt(e)}function un(){var e;return(e=function(){var e,t,n,s;if(e=Kt,r.substr(Kt,2)===m?(t=m,Kt+=2):(t=o,0===$t&&sn(Jr)),t!==o){if(n=[],Lr.test(r.charAt(Kt))?(s=r.charAt(Kt),Kt++):(s=o,0===$t&&sn(Hr)),s!==o)for(;s!==o;)n.push(s),Lr.test(r.charAt(Kt))?(s=r.charAt(Kt),Kt++):(s=o,0===$t&&sn(Hr));else n=o;n!==o?(r.substr(Kt,2)===w?(s=w,Kt+=2):(s=o,0===$t&&sn(zr)),s!==o?(Wt=e,e=gt(n)):(Kt=e,e=o)):(Kt=e,e=o)}else Kt=e,e=o;return e}())===o&&(e=function(){var e,t;return e=Kt,r.substr(Kt,3)===D?(t=D,Kt+=3):(t=o,0===$t&&sn(ve)),t!==o?(vn(),Wt=e,e=Ot()):(Kt=e,e=o),e}())===o&&(e=function(){var e;return(e=function(){var e,t,n,s,a,u,c;return e=Kt,vn(),t=Kt,r.substr(Kt,7)===dr?(n=dr,Kt+=7):(n=o,0===$t&&sn($e)),n!==o?(s=vn(),r.substr(Kt,8)===gr?(a=gr,Kt+=8):(a=o,0===$t&&sn(rt)),a!==o?(u=vn(),r.substr(Kt,1).toLowerCase()===mr?(c=r.charAt(Kt),Kt++):(c=o,0===$t&&sn(et)),c!==o?t=n=[n,s,a,u,c]:(Kt=t,t=o)):(Kt=t,t=o)):(Kt=t,t=o),t===o&&(t=Kt,r.substr(Kt,7)===dr?(n=dr,Kt+=7):(n=o,0===$t&&sn($e)),n!==o?(s=vn(),49===r.charCodeAt(Kt)?(a=mr,Kt++):(a=o,0===$t&&sn(tt)),a!==o?t=n=[n,s,a]:(Kt=t,t=o)):(Kt=t,t=o),t===o&&(t=Kt,r.substr(Kt,4)===wr?(n=wr,Kt+=4):(n=o,0===$t&&sn(nt)),n!==o?(s=vn(),49===r.charCodeAt(Kt)?(a=mr,Kt++):(a=o,0===$t&&sn(tt)),a!==o?t=n=[n,s,a]:(Kt=t,t=o)):(Kt=t,t=o))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),s=vn(),Wt=e,e=Jt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n,s,a,u,c;return e=Kt,vn(),t=Kt,r.substr(Kt,7)===dr?(n=dr,Kt+=7):(n=o,0===$t&&sn($e)),n!==o?(s=vn(),r.substr(Kt,8)===gr?(a=gr,Kt+=8):(a=o,0===$t&&sn(rt)),a!==o?(u=vn(),r.substr(Kt,1).toLowerCase()===yr?(c=r.charAt(Kt),Kt++):(c=o,0===$t&&sn(ot)),c!==o?t=n=[n,s,a,u,c]:(Kt=t,t=o)):(Kt=t,t=o)):(Kt=t,t=o),t===o&&(t=Kt,r.substr(Kt,7)===dr?(n=dr,Kt+=7):(n=o,0===$t&&sn($e)),n!==o?(s=vn(),50===r.charCodeAt(Kt)?(a=yr,Kt++):(a=o,0===$t&&sn(st)),a!==o?t=n=[n,s,a]:(Kt=t,t=o)):(Kt=t,t=o),t===o&&(t=Kt,r.substr(Kt,4)===wr?(n=wr,Kt+=4):(n=o,0===$t&&sn(nt)),n!==o?(s=vn(),50===r.charCodeAt(Kt)?(a=yr,Kt++):(a=o,0===$t&&sn(st)),a!==o?t=n=[n,s,a]:(Kt=t,t=o)):(Kt=t,t=o))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),s=vn(),Wt=e,e=Ht()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,10).toLowerCase()===Ir?(t=r.substr(Kt,10),Kt+=10):(t=o,0===$t&&sn(at)),t===o&&(r.substr(Kt,10).toLowerCase()===Ar?(t=r.substr(Kt,10),Kt+=10):(t=o,0===$t&&sn(ut)),t===o&&(r.substr(Kt,5).toLowerCase()===Cr?(t=r.substr(Kt,5),Kt+=5):(t=o,0===$t&&sn(ct)),t===o&&(r.substr(Kt,5).toLowerCase()===Rr?(t=r.substr(Kt,5),Kt+=5):(t=o,0===$t&&sn(it))))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=zt()):(Kt=e,e=o),e}()),e}())===o&&(e=function(){var e,t,n,s;if(e=Kt,vn(),r.substr(Kt,3).toLowerCase()===P?(t=r.substr(Kt,3),Kt+=3):(t=o,0===$t&&sn(he)),t===o&&(r.substr(Kt,5).toLowerCase()===q?(t=r.substr(Kt,5),Kt+=5):(t=o,0===$t&&sn(fe))),t!==o){if(vn(),n=[],Vr.test(r.charAt(Kt))?(s=r.charAt(Kt),Kt++):(s=o,0===$t&&sn(be)),s!==o)for(;s!==o;)n.push(s),Vr.test(r.charAt(Kt))?(s=r.charAt(Kt),Kt++):(s=o,0===$t&&sn(be));else n=o;n!==o?(kr.test(r.charAt(Kt))?(s=r.charAt(Kt),Kt++):(s=o,0===$t&&sn(Pr)),s===o&&(s=null),vn(),Wt=e,e=xt(n)):(Kt=e,e=o)}else Kt=e,e=o;return e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,20).toLowerCase()===l?(t=r.substr(Kt,20),Kt+=20):(t=o,0===$t&&sn(Mr)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),Wt=e,e=pt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,21).toLowerCase()===f?(t=r.substr(Kt,21),Kt+=21):(t=o,0===$t&&sn(Tr)),t===o&&(r.substr(Kt,15).toLowerCase()===b?(t=r.substr(Kt,15),Kt+=15):(t=o,0===$t&&sn(Dr)),t===o&&(r.substr(Kt,3).toLowerCase()===p?(t=r.substr(Kt,3),Kt+=3):(t=o,0===$t&&sn(Gr)),t===o&&(r.substr(Kt,2).toLowerCase()===v?(t=r.substr(Kt,2),Kt+=2):(t=o,0===$t&&sn(Nr)),t===o&&(r.substr(Kt,9).toLowerCase()===d?(t=r.substr(Kt,9),Kt+=9):(t=o,0===$t&&sn(Ur)),t===o&&(r.substr(Kt,4).toLowerCase()===g?(t=r.substr(Kt,4),Kt+=4):(t=o,0===$t&&sn(_r))))))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),Wt=e,e=dt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,21).toLowerCase()===h?(t=r.substr(Kt,21),Kt+=21):(t=o,0===$t&&sn(qr)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),Wt=e,e=vt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n,s,a,u,i,l;return e=Kt,vn(),(t=cn())!==o&&(n=bn())!==o?(s=pn(),47===r.charCodeAt(Kt)?(a=c,Kt++):(a=o,0===$t&&sn(Qr)),a!==o&&(u=cn())!==o&&(i=bn())!==o?(l=pn(),dn(),Wt=e,e=ft(t,n,s,u,i,l)):(Kt=e,e=o)):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n,s,a,u,c,l;return e=Kt,vn(),(t=cn())!==o&&(n=bn())!==o?(s=pn(),r.substr(Kt,2)===i?(a=i,Kt+=2):(a=o,0===$t&&sn(Br)),a!==o&&(u=cn())!==o&&(c=bn())!==o?(l=pn(),dn(),Wt=e,e=bt(t,n,s,u,c,l)):(Kt=e,e=o)):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,8).toLowerCase()===y?(t=r.substr(Kt,8),Kt+=8):(t=o,0===$t&&sn(Kr)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=mt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,7).toLowerCase()===I?(t=r.substr(Kt,7),Kt+=7):(t=o,0===$t&&sn(Wr)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=wt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,7).toLowerCase()===A?(t=r.substr(Kt,7),Kt+=7):(t=o,0===$t&&sn(Xr)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=yt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,7).toLowerCase()===C?(t=r.substr(Kt,7),Kt+=7):(t=o,0===$t&&sn(Yr)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=It()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,9).toLowerCase()===S?(t=r.substr(Kt,9),Kt+=9):(t=o,0===$t&&sn(se)),t===o&&(r.substr(Kt,12).toLowerCase()===j?(t=r.substr(Kt,12),Kt+=12):(t=o,0===$t&&sn(ae))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=kt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,5).toLowerCase()===E?(t=r.substr(Kt,5),Kt+=5):(t=o,0===$t&&sn(ne)),t===o&&(r.substr(Kt,6).toLowerCase()===O?(t=r.substr(Kt,6),Kt+=6):(t=o,0===$t&&sn(oe))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=Rt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,5).toLowerCase()===L?(t=r.substr(Kt,5),Kt+=5):(t=o,0===$t&&sn(re)),t===o&&(r.substr(Kt,6).toLowerCase()===V?(t=r.substr(Kt,6),Kt+=6):(t=o,0===$t&&sn(ee)),t===o&&(r.substr(Kt,10).toLowerCase()===x?(t=r.substr(Kt,10),Kt+=10):(t=o,0===$t&&sn(te)))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=Ct()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,13).toLowerCase()===R?(t=r.substr(Kt,13),Kt+=13):(t=o,0===$t&&sn(Zr)),t===o&&(r.substr(Kt,5).toLowerCase()===k?(t=r.substr(Kt,5),Kt+=5):(t=o,0===$t&&sn($r))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=At()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,7).toLowerCase()===F?(t=r.substr(Kt,7),Kt+=7):(t=o,0===$t&&sn(ue)),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=Lt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,12).toLowerCase()===Q?(t=r.substr(Kt,12),Kt+=12):(t=o,0===$t&&sn(ce)),t===o&&(r.substr(Kt,15).toLowerCase()===B?(t=r.substr(Kt,15),Kt+=15):(t=o,0===$t&&sn(ie)),t===o&&(r.substr(Kt,14).toLowerCase()===M?(t=r.substr(Kt,14),Kt+=14):(t=o,0===$t&&sn(le)))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=Vt()):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n;return e=Kt,vn(),r.substr(Kt,6).toLowerCase()===N?(t=r.substr(Kt,6),Kt+=6):(t=o,0===$t&&sn(me)),t===o&&(r.substr(Kt,6).toLowerCase()===U?(t=r.substr(Kt,6),Kt+=6):(t=o,0===$t&&sn(we)),t===o&&(r.substr(Kt,8).toLowerCase()===_?(t=r.substr(Kt,8),Kt+=8):(t=o,0===$t&&sn(ye)),t===o&&(r.substr(Kt,6).toLowerCase()===J?(t=r.substr(Kt,6),Kt+=6):(t=o,0===$t&&sn(Ie)),t===o&&(r.substr(Kt,10).toLowerCase()===H?(t=r.substr(Kt,10),Kt+=10):(t=o,0===$t&&sn(Ae)),t===o&&(r.substr(Kt,7).toLowerCase()===z?(t=r.substr(Kt,7),Kt+=7):(t=o,0===$t&&sn(Ce)),t===o&&(r.substr(Kt,7).toLowerCase()===K?(t=r.substr(Kt,7),Kt+=7):(t=o,0===$t&&sn(Re)))))))),t!==o?(kr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(Pr)),n===o&&(n=null),vn(),Wt=e,e=jt(t)):(Kt=e,e=o),e}())===o&&(e=function(){var e,t,n,s,a;return e=Kt,vn(),r.substr(Kt,3).toLowerCase()===G?(t=r.substr(Kt,3),Kt+=3):(t=o,0===$t&&sn(de)),t!==o?(xr.test(r.charAt(Kt))?(n=r.charAt(Kt),Kt++):(n=o,0===$t&&sn(ge)),n===o&&(n=null),(s=ln())!==o?(kr.test(r.charAt(Kt))?(a=r.charAt(Kt),Kt++):(a=o,0===$t&&sn(Pr)),a===o&&(a=null),vn(),Wt=e,e=St(s)):(Kt=e,e=o)):(Kt=e,e=o),e}())===o&&(e=function(){var r,e,t,n;return r=Kt,vn(),(e=cn())!==o&&(t=bn())!==o?(n=pn(),dn(),Wt=r,r=ht(e,t,n)):(Kt=r,r=o),r}())===o&&(e=function(){var e,t;return e=Kt,vn(),124===r.charCodeAt(Kt)?(t=T,Kt++):(t=o,0===$t&&sn(pe)),t!==o?(vn(),Wt=e,e=Et()):(Kt=e,e=o),e}()),e}function cn(){var e;return(e=ln())===o&&(e=function(){var e,t,n,s;for(e=Kt,t=[],n=hn();n!==o;)t.push(n),n=hn();for(n=[],s=fn();s!==o;)n.push(s),s=fn();return r.substr(Kt,3)===W?(s=W,Kt+=3):(s=o,0===$t&&sn(Le)),s===o&&(r.substr(Kt,3)===X?(s=X,Kt+=3):(s=o,0===$t&&sn(Ve)),s===o&&(r.substr(Kt,2)===Y?(s=Y,Kt+=2):(s=o,0===$t&&sn(xe)),s===o&&(r.substr(Kt,2)===Z?(s=Z,Kt+=2):(s=o,0===$t&&sn(Ee)),s===o&&(r.substr(Kt,2)===$?(s=$,Kt+=2):(s=o,0===$t&&sn(Oe)),s===o&&(86===r.charCodeAt(Kt)?(s=rr,Kt++):(s=o,0===$t&&sn(Se)),s===o&&(73===r.charCodeAt(Kt)?(s=er,Kt++):(s=o,0===$t&&sn(je)))))))),s!==o?(Wt=e,e=Qt(t,n,s)):(Kt=e,e=o),e}()),e}function ln(){var e,t,n,s,a;if(e=Kt,Er.test(r.charAt(Kt))?(t=r.charAt(Kt),Kt++):(t=o,0===$t&&sn(ke)),t!==o){for(n=[],s=hn();s!==o;)n.push(s),s=hn();for(s=[],a=fn();a!==o;)s.push(a),a=fn();Wt=e,e=Ft(t,n,s)}else Kt=e,e=o;return e}function hn(){var e,t;return e=Kt,Or.test(r.charAt(Kt))?(t=r.charAt(Kt),Kt++):(t=o,0===$t&&sn(Fe)),t!==o&&(Wt=e,t=Bt()),t}function fn(){var e,t;return e=Kt,Sr.test(r.charAt(Kt))?(t=r.charAt(Kt),Kt++):(t=o,0===$t&&sn(Qe)),t!==o&&(Wt=e,t=Mt()),t}function bn(){var e,t;return e=Kt,t=function(){var e,t;return e=Kt,r.substr(Kt,4).toLowerCase()===lr?(t=r.substr(Kt,4),Kt+=4):(t=o,0===$t&&sn(Ue)),t===o&&(r.substr(Kt,2)===hr?(t=hr,Kt+=2):(t=o,0===$t&&sn(_e)),t===o&&(r.substr(Kt,2)===fr?(t=fr,Kt+=2):(t=o,0===$t&&sn(Je)))),t!==o&&(Wt=e,t=Ut()),e=t}(),t===o&&(t=function(){var e,t;return e=Kt,r.substr(Kt,4).toLowerCase()===or?(t=r.substr(Kt,4),Kt+=4):(t=o,0===$t&&sn(Pe)),t===o&&(r.substr(Kt,2)===sr?(t=sr,Kt+=2):(t=o,0===$t&&sn(qe)),t===o&&(9651===r.charCodeAt(Kt)?(t=ar,Kt++):(t=o,0===$t&&sn(Te)))),t!==o&&(Wt=e,t=Dt()),e=t}(),t===o&&(t=function(){var e,t;return e=Kt,r.substr(Kt,3).toLowerCase()===tr?(t=r.substr(Kt,3),Kt+=3):(t=o,0===$t&&sn(Be)),t!==o&&(Wt=e,t=qt()),e=t}(),t===o&&(t=function(){var e,t;return e=Kt,r.substr(Kt,3).toLowerCase()===ur?(t=r.substr(Kt,3),Kt+=3):(t=o,0===$t&&sn(De)),t!==o&&(Wt=e,t=Gt()),e=t}(),t===o&&(t=function(){var e,t;return e=Kt,109===r.charCodeAt(Kt)?(t=cr,Kt++):(t=o,0===$t&&sn(Ge)),t===o&&(45===r.charCodeAt(Kt)?(t=ir,Kt++):(t=o,0===$t&&sn(Ne))),t!==o&&(Wt=e,t=Nt()),e=t}(),t===o&&(t=function(){var e,t;return e=Kt,77===r.charCodeAt(Kt)?(t=nr,Kt++):(t=o,0===$t&&sn(Me)),t===o&&(t=""),t!==o&&(Wt=e,t=Tt()),e=t}()))))),t!==o&&(Wt=e,t=Pt(t)),t}function pn(){var e,t,n,s;return e=Kt,t=Kt,94===r.charCodeAt(Kt)?(n=br,Kt++):(n=o,0===$t&&sn(He)),n!==o?(jr.test(r.charAt(Kt))?(s=r.charAt(Kt),Kt++):(s=o,0===$t&&sn(ze)),s!==o?t=n=[n,s]:(Kt=t,t=o)):(Kt=t,t=o),t===o&&(t=null),Wt=e,_t()}function vn(){var e,t;for($t++,e=[],Fr.test(r.charAt(Kt))?(t=r.charAt(Kt),Kt++):(t=o,0===$t&&sn(We));t!==o;)e.push(t),Fr.test(r.charAt(Kt))?(t=r.charAt(Kt),Kt++):(t=o,0===$t&&sn(We));return $t--,t=o,0===$t&&sn(Ke),e}function dn(){var e,t,n,s;for($t++,e=[],r.substr(Kt,3)===pr?(t=pr,Kt+=3):(t=o,0===$t&&sn(Ye)),t===o&&(t=Kt,n=vn(),8594===r.charCodeAt(Kt)?(s=vr,Kt++):(s=o,0===$t&&sn(Ze)),s!==o?t=n=[n,s,vn()]:(Kt=t,t=o));t!==o;)e.push(t),r.substr(Kt,3)===pr?(t=pr,Kt+=3):(t=o,0===$t&&sn(Ye)),t===o&&(t=Kt,n=vn(),8594===r.charCodeAt(Kt)?(s=vr,Kt++):(s=o,0===$t&&sn(Ze)),s!==o?t=n=[n,s,vn()]:(Kt=t,t=o));return $t--,t=o,0===$t&&sn(Xe),e}let gn=0,mn="ionian";if((n=u())!==o&&Kt===r.length)return n;throw n!==o&&Kt<r.length&&sn({type:"end"}),wn=Zt,yn=Yt<r.length?r.charAt(Yt):null,In=Yt<r.length?on(Yt,Yt+1):on(Yt,Yt),new e(e.buildMessage(wn,yn),wn,yn,In);var wn,yn,In}}}},e={};function t(n){var o=e[n];if(void 0!==o)return o.exports;var s=e[n]={exports:{}};return r[n](s,s.exports,t),s.exports}t.d=(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},t.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),t.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var n={};return(()=>{t.r(n),t.d(n,{chord2mml:()=>v});var r=t(699);function e(r,e,t){for(var n=e.length*t,o=0,s=e;o<s.length;o++)r[s[o]].noteLength=n;return r}var o=function(r,e,t){if(t||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return r.concat(n||Array.prototype.slice.call(e))};function s(r){return delete r.event,delete r.root,delete r.quality,delete r.inversion,delete r.upperRoot,delete r.upperQuality,delete r.upperInversion,delete r.lowerRoot,delete r.lowerQuality,delete r.lowerInversion,r}function a(r,e,t,n){void 0===t&&(t="root inv"),void 0===n&&(n="close");var o=[];switch(e){case"maj":o=[0,4,7];break;case"maj7":o=[0,4,7,11];break;case"min":o=[0,3,7];break;case"min7":o=[0,3,7,10]}return u(o=c(o,r),t,n)}function u(r,e,t){switch(e){case"1st inv":r=b(r,1);break;case"2nd inv":r=b(r,2);break;case"3rd inv":r=b(r,3)}switch(t){case"drop2":r=function(r){if(r.length<2)return r;var e=r[r.length-2]-12;return r.splice(r.length-2,1),r.unshift(e),r}(r);break;case"drop4":r=function(r){if(r.length<4)return r;var e=r[r.length-4]-12;return r.splice(r.length-4,1),r.unshift(e),r}(r);break;case"drop2and4":r=function(r){if(r.length<4)return r;var e=r[r.length-2]-12,t=r[r.length-4]-12;return r.splice(r.length-2,1),r.splice(r.length-4+1,1),r.unshift(e),r.unshift(t),r}(r)}return r}function c(r,e){for(var t=0;t<r.length;t++)r[t]+=e;return r}function i(r,e,t,n,o){var s=[];s.push(t);var a=l(r,e,t);return a=u(a,n,o),s.push.apply(s,a),s}function l(r,e,t){var n=a(r,e);return r<=t&&(n=c(n,12)),n}function h(r,e,t,n){var o=[];if("root"==n){o.push(r);var s=l(r,e,r);s=f(s,t),o.push.apply(o,s),o=c(o,-12)}else o=f(o=a(r,e),t);return o}function f(r,e){for(var t=!1,n=0,o=r;n<o.length;n++){if(o[n],(r[0]%12+12)%12==(e%12+12)%12){t=!0;break}r.push(r.shift())}if(t)return p(r);throw new Error("ERROR : ".concat(JSON.stringify(r)," を転回しようとしましたが、chordに ").concat(JSON.stringify(e)," が含まれていません。chordに含まれるnoteを指定してください。"))}function b(r,e){for(var t=0;t<e;t++)r.push(r.shift());return p(r)}function p(r){for(var e=-1,t=0;t<r.length;t++){for(var n=0;n<128&&!(r[t]>e);n+=12)r[t]+=12;e=r[t]}return r}var v={parse:r.parse};v.parse=function(t){var n=(0,r.parse)(t);return function(r){for(var e="",t=0,n=r;t<n.length;t++){var o=n[t];switch(o.event){case"inline mml":e+=o.mml;continue;case"bar":e+="/*|*/";continue}var s=o.notes;if(s){var a=0;s.length&&(e+="'");for(var u=s[0];u<0;)u+=12,e+=">",a--;for(var c=0;c<s.length;c++){var i=s[c],l=Math.floor(i/12);switch(l>a&&(e+="<",a=l),(i%12+12)%12){case 0:e+="c";break;case 1:e+="c+";break;case 2:e+="d";break;case 3:e+="d+";break;case 4:e+="e";break;case 5:e+="f";break;case 6:e+="f+";break;case 7:e+="g";break;case 8:e+="g+";break;case 9:e+="a";break;case 10:e+="a+";break;case 11:e+="b"}!c&&o.noteLength&&(e+=o.noteLength)}s.length&&(e+="'")}}return e}(function(r){for(var e,t,n,u,l=[],f="root inv",b="close",v="no bass",d=0,g=r;d<g.length;d++){var m=g[d];switch(m.event){case"chord":m.notes=a(m.root,m.quality,null!==(e=m.inversion)&&void 0!==e?e:f,b),m=s(m),l.push(m);break;case"chord over bass note":m.notes=i(m.upperRoot,m.upperQuality,m.lowerRoot,null!==(t=m.upperInversion)&&void 0!==t?t:f,b),m.notes=c(m.notes,-12),m=s(m),l.push(m);break;case"inversion":m.notes=h(m.upperRoot,m.upperQuality,m.lowerRoot,v),m=s(m),l.push(m);break;case"polychord":m.notes=(w=m.upperRoot,y=m.upperQuality,I=null!==(n=m.upperInversion)&&void 0!==n?n:f,A=m.lowerRoot,C=m.lowerQuality,R=null!==(u=m.lowerInversion)&&void 0!==u?u:f,k=void 0,L=void 0,void 0,k=a(A,C,R),L=a(w,y,I),p(o(o([],k,!0),L,!0))),m=s(m),l.push(m);break;case"change inversion mode to root inv":f="root inv";break;case"change inversion mode to 1st inv":f="1st inv";break;case"change inversion mode to 2nd inv":f="2nd inv";break;case"change inversion mode to 3rd inv":f="3rd inv";break;case"change open harmony mode to close":b="close";break;case"change open harmony mode to drop2":b="drop2";break;case"change open harmony mode to drop4":b="drop4";break;case"change open harmony mode to drop2and4":b="drop2and4";break;case"change bass play mode to root":v="root";break;case"change bass play mode to no bass":v="no bass";break;default:l.push(m)}}var w,y,I,A,C,R,k,L;return l}(n=function(r){for(var t="chord over bass note",n="no bass",o=0,s=r;o<s.length;o++){var a=s[o];switch(a.event){case"change slash chord mode to chord over bass note":t="chord over bass note";break;case"change slash chord mode to inversion":t="inversion";break;case"change slash chord mode to polychord":t="polychord";break;case"slash chord":a.event=t;break;case"change bass play mode to root":n="root";break;case"change bass play mode to no bass":n="no bass";break;case"chord":"root"==n&&(a.event="chord over bass note",a.upperRoot=a.root,a.upperQuality=a.quality,a.upperInversion=a.inversion,a.lowerRoot=a.root,a.lowerQuality=a.quality,a.lowerInversion=a.inversion,delete a.root,delete a.quality,delete a.inversion)}}return r=function(r){for(var t=0,n=1,o=[],s=0;s<r.length;s++){var a=r[s];switch(a.event){case"chord":case"chord over bass note":case"inversion":case"polychord":a.noteLength=1,o.push(s);break;case"bar":t++,r=e(r,o,n),o=[],n=1;break;case"bar slash":t++,r=e(r,o,n=2),o=[]}}return t&&(r=e(r,o,n)),r}(r),r}(n)))}})(),n})()));