!function(e,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:e)[n]=t[n]}}(self,(()=>(()=>{"use strict";var e={699:e=>{function r(e,t,n,o){var s=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(s,r.prototype),s.expected=t,s.found=n,s.location=o,s.name="SyntaxError",s}function t(e,r,t){return t=t||" ",e.length>r?e:(r-=e.length,e+(t+=t.repeat(r)).slice(0,r))}!function(e,r){function t(){this.constructor=e}t.prototype=r.prototype,e.prototype=new t}(r,Error),r.prototype.format=function(e){var r="Error: "+this.message;if(this.location){var n,o=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){o=e[n].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,a=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,u=this.location.source+":"+a.line+":"+a.column;if(o){var c=this.location.end,i=t("",a.line.toString().length," "),l=o[s.line-1],h=(s.line===c.line?c.column:l.length+1)-s.column||1;r+="\n --\x3e "+u+"\n"+i+" |\n"+a.line+" | "+l+"\n"+i+" | "+t("",s.column-1," ")+t("",h,"^")}else r+="\n at "+u}return r},r.buildMessage=function(e,r){var t={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var r=e.parts.map((function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)}));return"["+(e.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return t[e.type](e)}return"Expected "+function(e){var r,t,n=e.map(a);if(n.sort(),n.length>0){for(r=1,t=1;r<n.length;r++)n[r-1]!==n[r]&&(n[t]=n[r],t++);n.length=t}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(r)+" found."},e.exports={SyntaxError:r,parse:function(e,t){var n,o,s,a,u={},c=(t=void 0!==t?t:{}).grammarSource,i={CHORDS:Zr},l=Zr,h="/",f="on",p="chord over bass note",d="slash chord inversion",b="upper structure triad",v="upper structure",g="ust",m="us",y="polychord",w="poly",A="/*",k="*/",C="root inv",L="1st inv",x="2nd inv",R="3rd inv",j="close harmony",Q="close",S="drop2",O="drop-2",F="open triad",E="drop4",M="drop-4",P="drop2and4",q="drop-2-and-4",T="no bass",D="bass is root",G="bass plays root",U="bass play root",B="bpm",J="tempo",N="|",_=" / ",H="maj",z="M",I="maj7",K="M7",V="△",W="min",X="m",Y="-",Z="min7",$="m7",ee="-7",re=" - ",te="→",ne=/^[,.]/,oe=/^[^*\/]/,se=/^[0-9]/,ae=/^[A-G]/,ue=/^[#\uFF03\u266F]/,ce=/^[b\u266D]/,ie=/^[ \t\n\r]/,le=Ir("/",!1),he=Ir("on",!1),fe=Ir("chord over bass note",!0),pe=Kr([",","."],!1,!1),de=Ir("slash chord inversion",!0),be=Ir("upper structure triad",!0),ve=Ir("upper structure",!0),ge=Ir("UST",!0),me=Ir("US",!0),ye=Ir("polychord",!0),we=Ir("poly",!0),Ae=Ir("/*",!1),ke=Kr(["*","/"],!0,!1),Ce=Ir("*/",!1),Le=Ir("root inv",!0),xe=Ir("1st inv",!0),Re=Ir("2nd inv",!0),je=Ir("3rd inv",!0),Qe=Ir("close harmony",!0),Se=Ir("close",!0),Oe=Ir("drop2",!0),Fe=Ir("drop-2",!0),Ee=Ir("open triad",!0),Me=Ir("drop4",!0),Pe=Ir("drop-4",!0),qe=Ir("drop2and4",!0),Te=Ir("drop-2-and-4",!0),De=Ir("no bass",!0),Ge=Ir("bass is root",!0),Ue=Ir("bass plays root",!0),Be=Ir("bass play root",!0),Je=Ir("BPM",!0),Ne=Ir("TEMPO",!0),_e=Kr([["0","9"]],!1,!1),He=Ir("|",!1),ze=Ir(" / ",!1),Ie=Kr([["A","G"]],!1,!1),Ke=Kr(["#","＃","♯"],!1,!1),Ve=Kr(["b","♭"],!1,!1),We=Ir("maj",!0),Xe=Ir("M",!1),Ye=Ir("maj7",!0),Ze=Ir("M7",!1),$e=Ir("△",!1),er=Ir("min",!0),rr=Ir("m",!1),tr=Ir("-",!1),nr=Ir("min7",!0),or=Ir("m7",!1),sr=Ir("-7",!1),ar=Vr("whitespace"),ur=Kr([" ","\t","\n","\r"],!1,!1),cr=Vr("hyphen"),ir=Ir(" - ",!1),lr=Ir("→",!1),hr=function(e,r){return{event:"chord",root:e,quality:r}},fr=function(e,r,t,n){return{event:"slash chord",upperRoot:e,upperQuality:r,lowerRoot:t,lowerQuality:n}},pr=function(e,r,t,n){return{event:"chord over bass note",upperRoot:e,upperQuality:r,lowerRoot:t,lowerQuality:n}},dr=function(){return{event:"change slash chord mode to chord over bass note"}},br=function(){return{event:"change slash chord mode to inversion"}},vr=function(){return{event:"change slash chord mode to polychord"}},gr=function(e){return{event:"inline mml",mml:e.join("")}},mr=function(){return{event:"change inversion mode to root inv"}},yr=function(){return{event:"change inversion mode to 1st inv"}},wr=function(){return{event:"change inversion mode to 2nd inv"}},Ar=function(){return{event:"change inversion mode to 3rd inv"}},kr=function(){return{event:"change open harmony mode to close"}},Cr=function(){return{event:"change open harmony mode to drop2"}},Lr=function(){return{event:"change open harmony mode to drop4"}},xr=function(){return{event:"change open harmony mode to drop2and4"}},Rr=function(){return{event:"change bass play mode to no bass"}},jr=function(){return{event:"change bass play mode to root"}},Qr=function(e){return{event:"inline mml",mml:"t"+e.join("")}},Sr=function(){return{event:"bar"}},Or=function(){return{event:"bar slash"}},Fr=function(e,r,t){let n;switch(e){case"C":n=0;break;case"D":n=2;break;case"E":n=4;break;case"F":n=5;break;case"G":n=7;break;case"A":n=9;break;case"B":n=11}return n+=r.length-t.length,n%=12,n},Er=function(){return"#"},Mr=function(){return"b"},Pr=function(e){return e},qr=function(){return"maj"},Tr=function(){return"maj"},Dr=function(){return"maj7"},Gr=function(){return"min"},Ur=function(){return"min"},Br=function(){return"min7"},Jr=0,Nr=[{line:1,column:1}],_r=0,Hr=[],zr=0;if("startRule"in t){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');l=i[t.startRule]}function Ir(e,r){return{type:"literal",text:e,ignoreCase:r}}function Kr(e,r,t){return{type:"class",parts:e,inverted:r,ignoreCase:t}}function Vr(e){return{type:"other",description:e}}function Wr(r){var t,n=Nr[r];if(n)return n;for(t=r-1;!Nr[t];)t--;for(n={line:(n=Nr[t]).line,column:n.column};t<r;)10===e.charCodeAt(t)?(n.line++,n.column=1):n.column++,t++;return Nr[r]=n,n}function Xr(e,r,t){var n=Wr(e),o=Wr(r),s={source:c,start:{offset:e,line:n.line,column:n.column},end:{offset:r,line:o.line,column:o.column}};return t&&c&&"function"==typeof c.offset&&(s.start=c.offset(s.start),s.end=c.offset(s.end)),s}function Yr(e){Jr<_r||(Jr>_r&&(_r=Jr,Hr=[]),Hr.push(e))}function Zr(){var e,r;for(e=[],r=$r();r!==u;)e.push(r),r=$r();return e}function $r(){var r;return(r=function(){var r,t,n,o;if(r=Jr,e.substr(Jr,2)===A?(t=A,Jr+=2):(t=u,0===zr&&Yr(Ae)),t!==u){if(n=[],oe.test(e.charAt(Jr))?(o=e.charAt(Jr),Jr++):(o=u,0===zr&&Yr(ke)),o!==u)for(;o!==u;)n.push(o),oe.test(e.charAt(Jr))?(o=e.charAt(Jr),Jr++):(o=u,0===zr&&Yr(ke));else n=u;n!==u?(e.substr(Jr,2)===k?(o=k,Jr+=2):(o=u,0===zr&&Yr(Ce)),o!==u?r=gr(n):(Jr=r,r=u)):(Jr=r,r=u)}else Jr=r,r=u;return r}())===u&&(r=function(){var r,t;return r=Jr,e.substr(Jr,3)===_?(t=_,Jr+=3):(t=u,0===zr&&Yr(ze)),t!==u?(ot(),r=Or()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n,o;if(r=Jr,ot(),e.substr(Jr,3).toLowerCase()===B?(t=e.substr(Jr,3),Jr+=3):(t=u,0===zr&&Yr(Je)),t===u&&(e.substr(Jr,5).toLowerCase()===J?(t=e.substr(Jr,5),Jr+=5):(t=u,0===zr&&Yr(Ne))),t!==u){if(ot(),n=[],se.test(e.charAt(Jr))?(o=e.charAt(Jr),Jr++):(o=u,0===zr&&Yr(_e)),o!==u)for(;o!==u;)n.push(o),se.test(e.charAt(Jr))?(o=e.charAt(Jr),Jr++):(o=u,0===zr&&Yr(_e));else n=u;n!==u?(ne.test(e.charAt(Jr))?(o=e.charAt(Jr),Jr++):(o=u,0===zr&&Yr(pe)),o===u&&(o=null),ot(),r=Qr(n)):(Jr=r,r=u)}else Jr=r,r=u;return r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,20).toLowerCase()===p?(t=e.substr(Jr,20),Jr+=20):(t=u,0===zr&&Yr(fe)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),r=dr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,21).toLowerCase()===b?(t=e.substr(Jr,21),Jr+=21):(t=u,0===zr&&Yr(be)),t===u&&(e.substr(Jr,15).toLowerCase()===v?(t=e.substr(Jr,15),Jr+=15):(t=u,0===zr&&Yr(ve)),t===u&&(e.substr(Jr,3).toLowerCase()===g?(t=e.substr(Jr,3),Jr+=3):(t=u,0===zr&&Yr(ge)),t===u&&(e.substr(Jr,2).toLowerCase()===m?(t=e.substr(Jr,2),Jr+=2):(t=u,0===zr&&Yr(me)),t===u&&(e.substr(Jr,9).toLowerCase()===y?(t=e.substr(Jr,9),Jr+=9):(t=u,0===zr&&Yr(ye)),t===u&&(e.substr(Jr,4).toLowerCase()===w?(t=e.substr(Jr,4),Jr+=4):(t=u,0===zr&&Yr(we))))))),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),r=vr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,21).toLowerCase()===d?(t=e.substr(Jr,21),Jr+=21):(t=u,0===zr&&Yr(de)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),r=br()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n,o,s,a;return r=Jr,ot(),(t=et())!==u&&(n=nt())!==u?(47===e.charCodeAt(Jr)?(o=h,Jr++):(o=u,0===zr&&Yr(le)),o!==u&&(s=et())!==u&&(a=nt())!==u?(st(),r=fr(t,n,s,a)):(Jr=r,r=u)):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n,o,s,a;return r=Jr,ot(),(t=et())!==u&&(n=nt())!==u?(e.substr(Jr,2)===f?(o=f,Jr+=2):(o=u,0===zr&&Yr(he)),o!==u&&(s=et())!==u&&(a=nt())!==u?(st(),r=pr(t,n,s,a)):(Jr=r,r=u)):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,8).toLowerCase()===C?(t=e.substr(Jr,8),Jr+=8):(t=u,0===zr&&Yr(Le)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=mr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,7).toLowerCase()===L?(t=e.substr(Jr,7),Jr+=7):(t=u,0===zr&&Yr(xe)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=yr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,7).toLowerCase()===x?(t=e.substr(Jr,7),Jr+=7):(t=u,0===zr&&Yr(Re)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=wr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,7).toLowerCase()===R?(t=e.substr(Jr,7),Jr+=7):(t=u,0===zr&&Yr(je)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=Ar()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,9).toLowerCase()===P?(t=e.substr(Jr,9),Jr+=9):(t=u,0===zr&&Yr(qe)),t===u&&(e.substr(Jr,12).toLowerCase()===q?(t=e.substr(Jr,12),Jr+=12):(t=u,0===zr&&Yr(Te))),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=xr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,5).toLowerCase()===E?(t=e.substr(Jr,5),Jr+=5):(t=u,0===zr&&Yr(Me)),t===u&&(e.substr(Jr,6).toLowerCase()===M?(t=e.substr(Jr,6),Jr+=6):(t=u,0===zr&&Yr(Pe))),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=Lr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,5).toLowerCase()===S?(t=e.substr(Jr,5),Jr+=5):(t=u,0===zr&&Yr(Oe)),t===u&&(e.substr(Jr,6).toLowerCase()===O?(t=e.substr(Jr,6),Jr+=6):(t=u,0===zr&&Yr(Fe)),t===u&&(e.substr(Jr,10).toLowerCase()===F?(t=e.substr(Jr,10),Jr+=10):(t=u,0===zr&&Yr(Ee)))),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=Cr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,13).toLowerCase()===j?(t=e.substr(Jr,13),Jr+=13):(t=u,0===zr&&Yr(Qe)),t===u&&(e.substr(Jr,5).toLowerCase()===Q?(t=e.substr(Jr,5),Jr+=5):(t=u,0===zr&&Yr(Se))),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=kr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,7).toLowerCase()===T?(t=e.substr(Jr,7),Jr+=7):(t=u,0===zr&&Yr(De)),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=Rr()):(Jr=r,r=u),r}())===u&&(r=function(){var r,t,n;return r=Jr,ot(),e.substr(Jr,12).toLowerCase()===D?(t=e.substr(Jr,12),Jr+=12):(t=u,0===zr&&Yr(Ge)),t===u&&(e.substr(Jr,15).toLowerCase()===G?(t=e.substr(Jr,15),Jr+=15):(t=u,0===zr&&Yr(Ue)),t===u&&(e.substr(Jr,14).toLowerCase()===U?(t=e.substr(Jr,14),Jr+=14):(t=u,0===zr&&Yr(Be)))),t!==u?(ne.test(e.charAt(Jr))?(n=e.charAt(Jr),Jr++):(n=u,0===zr&&Yr(pe)),n===u&&(n=null),ot(),r=jr()):(Jr=r,r=u),r}())===u&&(r=function(){var e,r,t;return e=Jr,ot(),(r=et())!==u&&(t=nt())!==u?(st(),e=hr(r,t)):(Jr=e,e=u),e}())===u&&(r=function(){var r,t;return r=Jr,ot(),124===e.charCodeAt(Jr)?(t=N,Jr++):(t=u,0===zr&&Yr(He)),t!==u?(ot(),r=Sr()):(Jr=r,r=u),r}()),r}function et(){var r,t,n,o,s;if(r=Jr,ae.test(e.charAt(Jr))?(t=e.charAt(Jr),Jr++):(t=u,0===zr&&Yr(Ie)),t!==u){for(n=[],o=rt();o!==u;)n.push(o),o=rt();for(o=[],s=tt();s!==u;)o.push(s),s=tt();r=Fr(t,n,o)}else Jr=r,r=u;return r}function rt(){var r;return Jr,ue.test(e.charAt(Jr))?(r=e.charAt(Jr),Jr++):(r=u,0===zr&&Yr(Ke)),r!==u&&(r=Er()),r}function tt(){var r;return Jr,ce.test(e.charAt(Jr))?(r=e.charAt(Jr),Jr++):(r=u,0===zr&&Yr(Ve)),r!==u&&(r=Mr()),r}function nt(){var r;return Jr,(r=function(){var r;return Jr,e.substr(Jr,4).toLowerCase()===Z?(r=e.substr(Jr,4),Jr+=4):(r=u,0===zr&&Yr(nr)),r===u&&(e.substr(Jr,2)===$?(r=$,Jr+=2):(r=u,0===zr&&Yr(or)),r===u&&(e.substr(Jr,2)===ee?(r=ee,Jr+=2):(r=u,0===zr&&Yr(sr)))),r!==u&&(r=Br()),r}())===u&&((r=function(){var r;return Jr,e.substr(Jr,4).toLowerCase()===I?(r=e.substr(Jr,4),Jr+=4):(r=u,0===zr&&Yr(Ye)),r===u&&(e.substr(Jr,2)===K?(r=K,Jr+=2):(r=u,0===zr&&Yr(Ze)),r===u&&(9651===e.charCodeAt(Jr)?(r=V,Jr++):(r=u,0===zr&&Yr($e)))),r!==u&&(r=Dr()),r}())===u&&((r=function(){var r;return Jr,e.substr(Jr,3).toLowerCase()===H?(r=e.substr(Jr,3),Jr+=3):(r=u,0===zr&&Yr(We)),r!==u&&(r=qr()),r}())===u&&((r=function(){var r;return Jr,e.substr(Jr,3).toLowerCase()===W?(r=e.substr(Jr,3),Jr+=3):(r=u,0===zr&&Yr(er)),r!==u&&(r=Gr()),r}())===u&&((r=function(){var r;return Jr,109===e.charCodeAt(Jr)?(r=X,Jr++):(r=u,0===zr&&Yr(rr)),r===u&&(45===e.charCodeAt(Jr)?(r=Y,Jr++):(r=u,0===zr&&Yr(tr))),r!==u&&(r=Ur()),r}())===u&&(r=function(){var r;return Jr,77===e.charCodeAt(Jr)?(r=z,Jr++):(r=u,0===zr&&Yr(Xe)),r===u&&(r=""),r!==u&&(r=Tr()),r}()))))),r!==u&&(r=Pr(r)),r}function ot(){var r,t;for(zr++,r=[],ie.test(e.charAt(Jr))?(t=e.charAt(Jr),Jr++):(t=u,0===zr&&Yr(ur));t!==u;)r.push(t),ie.test(e.charAt(Jr))?(t=e.charAt(Jr),Jr++):(t=u,0===zr&&Yr(ur));return zr--,t=u,0===zr&&Yr(ar),r}function st(){var r,t,n,o;for(zr++,r=[],e.substr(Jr,3)===re?(t=re,Jr+=3):(t=u,0===zr&&Yr(ir)),t===u&&(t=Jr,n=ot(),8594===e.charCodeAt(Jr)?(o=te,Jr++):(o=u,0===zr&&Yr(lr)),o!==u?t=n=[n,o,ot()]:(Jr=t,t=u));t!==u;)r.push(t),e.substr(Jr,3)===re?(t=re,Jr+=3):(t=u,0===zr&&Yr(ir)),t===u&&(t=Jr,n=ot(),8594===e.charCodeAt(Jr)?(o=te,Jr++):(o=u,0===zr&&Yr(lr)),o!==u?t=n=[n,o,ot()]:(Jr=t,t=u));return zr--,t=u,0===zr&&Yr(cr),r}if((n=l())!==u&&Jr===e.length)return n;throw n!==u&&Jr<e.length&&Yr({type:"end"}),o=Hr,s=_r<e.length?e.charAt(_r):null,a=_r<e.length?Xr(_r,_r+1):Xr(_r,_r),new r(r.buildMessage(o,s),o,s,a)}}}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var s=r[n]={exports:{}};return e[n](s,s.exports,t),s.exports}t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{t.r(n),t.d(n,{chord2mml:()=>d});var e=t(699);function r(e,r,t){for(var n=r.length*t,o=0,s=r;o<s.length;o++)e[s[o]].noteLength=n;return e}var o=function(e,r,t){if(t||2===arguments.length)for(var n,o=0,s=r.length;o<s;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))};function s(e,r,t,n){void 0===t&&(t="root inv"),void 0===n&&(n="close");var o=[];switch(r){case"maj":o=[0,4,7];break;case"maj7":o=[0,4,7,11];break;case"min":o=[0,3,7];break;case"min7":o=[0,3,7,10]}return a(o=u(o,e),t,n)}function a(e,r,t){switch(r){case"1st inv":e=f(e,1);break;case"2nd inv":e=f(e,2);break;case"3rd inv":e=f(e,3)}switch(t){case"drop2":e=function(e){if(e.length<2)return e;var r=e[e.length-2]-12;return e.splice(e.length-2,1),e.unshift(r),e}(e);break;case"drop4":e=function(e){if(e.length<4)return e;var r=e[e.length-4]-12;return e.splice(e.length-4,1),e.unshift(r),e}(e);break;case"drop2and4":e=function(e){if(e.length<4)return e;var r=e[e.length-2]-12,t=e[e.length-4]-12;return e.splice(e.length-2,1),e.splice(e.length-4+1,1),e.unshift(r),e.unshift(t),e}(e)}return e}function u(e,r){for(var t=0;t<e.length;t++)e[t]+=r;return e}function c(e,r,t,n,o){var s=[];s.push(t);var u=i(e,r,t);return u=a(u,n,o),s.push.apply(s,u),s}function i(e,r,t){var n=s(e,r);return e<=t&&(n=u(n,12)),n}function l(e,r,t,n){var o=[];if("root"==n){o.push(e);var a=i(e,r,e);a=h(a,t),o.push.apply(o,a),o=u(o,-12)}else o=h(o=s(e,r),t);return o}function h(e,r){for(var t=!1,n=0,o=e;n<o.length;n++){if(o[n],(e[0]%12+12)%12==(r%12+12)%12){t=!0;break}e.push(e.shift())}if(t)return p(e);throw new Error("ERROR : ".concat(JSON.stringify(e)," を転回しようとしましたが、chordに ").concat(JSON.stringify(r)," が含まれていません。chordに含まれるnoteを指定してください。"))}function f(e,r){for(var t=0;t<r;t++)e.push(e.shift());return p(e)}function p(e){for(var r=-1,t=0;t<e.length;t++){for(var n=0;n<128&&!(e[t]>r);n+=12)e[t]+=12;r=e[t]}return e}var d={parse:e.parse};d.parse=function(t){var n=(0,e.parse)(t);return function(e){for(var r="",t=0,n=e;t<n.length;t++){var o=n[t];switch(o.event){case"inline mml":r+=o.mml;continue;case"bar":r+="/*|*/";continue}var s=o.notes;if(s){var a=0;s.length&&(r+="'");for(var u=s[0];u<0;)u+=12,r+=">",a--;for(var c=0;c<s.length;c++){var i=s[c],l=Math.floor(i/12);switch(l>a&&(r+="<",a=l),(i%12+12)%12){case 0:r+="c";break;case 1:r+="c+";break;case 2:r+="d";break;case 3:r+="d+";break;case 4:r+="e";break;case 5:r+="f";break;case 6:r+="f+";break;case 7:r+="g";break;case 8:r+="g+";break;case 9:r+="a";break;case 10:r+="a+";break;case 11:r+="b"}!c&&o.noteLength&&(r+=o.noteLength)}s.length&&(r+="'")}}return r}(function(e){for(var r=[],t="root inv",n="close",a="no bass",i=0,h=e;i<h.length;i++){var f=h[i];switch(f.event){case"chord":f.notes=s(f.root,f.quality,t,n),delete f.event,delete f.root,delete f.quality,r.push(f);break;case"chord over bass note":f.notes=c(f.upperRoot,f.upperQuality,f.lowerRoot,t,n),f.notes=u(f.notes,-12),delete f.event,delete f.upperRoot,delete f.upperQuality,delete f.lowerRoot,delete f.lowerQuality,r.push(f);break;case"inversion":f.notes=l(f.upperRoot,f.upperQuality,f.lowerRoot,a),delete f.event,delete f.upperRoot,delete f.upperQuality,delete f.lowerRoot,delete f.lowerQuality,r.push(f);break;case"polychord":f.notes=(d=f.upperRoot,b=f.upperQuality,v=f.lowerRoot,g=f.lowerQuality,m=void 0,y=void 0,void 0,m=s(v,g),y=s(d,b),p(o(o([],m,!0),y,!0))),delete f.event,delete f.upperRoot,delete f.upperQuality,delete f.lowerRoot,delete f.lowerQuality,r.push(f);break;case"change inversion mode to root inv":t="root inv";break;case"change inversion mode to 1st inv":t="1st inv";break;case"change inversion mode to 2nd inv":t="2nd inv";break;case"change inversion mode to 3rd inv":t="3rd inv";break;case"change open harmony mode to close":n="close";break;case"change open harmony mode to drop2":n="drop2";break;case"change open harmony mode to drop4":n="drop4";break;case"change open harmony mode to drop2and4":n="drop2and4";break;case"change bass play mode to root":a="root";break;case"change bass play mode to no bass":a="no bass";break;default:r.push(f)}}var d,b,v,g,m,y;return r}(n=function(e){for(var t="chord over bass note",n="no bass",o=0,s=e;o<s.length;o++){var a=s[o];switch(a.event){case"change slash chord mode to chord over bass note":t="chord over bass note";break;case"change slash chord mode to inversion":t="inversion";break;case"change slash chord mode to polychord":t="polychord";break;case"slash chord":a.event=t;break;case"change bass play mode to root":n="root";break;case"change bass play mode to no bass":n="no bass";break;case"chord":"root"==n&&(a.event="chord over bass note",a.upperRoot=a.root,a.upperQuality=a.quality,a.lowerRoot=a.root,a.lowerQuality=a.quality,delete a.root,delete a.quality)}}return function(e){for(var t=0,n=1,o=[],s=0;s<e.length;s++)switch(e[s].event){case"chord":case"chord over bass note":case"inversion":case"polychord":o.push(s);break;case"bar":t++,e=r(e,o,n),o=[],n=1;break;case"bar slash":t++,e=r(e,o,n=2),o=[]}return t&&(e=r(e,o,n)),e}(e)}(n)))}})(),n})()));